<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>i8257.c source code [codebrowser/hw/dma/i8257.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'codebrowser/hw/dma/i8257.c'; var root_path = '../../..'; var data_path = '../../../../data';</script>
<script src='../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../..'>codebrowser</a>/<a href='..'>hw</a>/<a href='./'>dma</a>/<a href='i8257.c.html'>i8257.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> * QEMU DMA emulation</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> * Copyright (c) 2003-2004 Vassili Karpov (malc)</i></td></tr>
<tr><th id="5">5</th><td><i> *</i></td></tr>
<tr><th id="6">6</th><td><i> * Permission is hereby granted, free of charge, to any person obtaining a copy</i></td></tr>
<tr><th id="7">7</th><td><i> * of this software and associated documentation files (the "Software"), to deal</i></td></tr>
<tr><th id="8">8</th><td><i> * in the Software without restriction, including without limitation the rights</i></td></tr>
<tr><th id="9">9</th><td><i> * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</i></td></tr>
<tr><th id="10">10</th><td><i> * copies of the Software, and to permit persons to whom the Software is</i></td></tr>
<tr><th id="11">11</th><td><i> * furnished to do so, subject to the following conditions:</i></td></tr>
<tr><th id="12">12</th><td><i> *</i></td></tr>
<tr><th id="13">13</th><td><i> * The above copyright notice and this permission notice shall be included in</i></td></tr>
<tr><th id="14">14</th><td><i> * all copies or substantial portions of the Software.</i></td></tr>
<tr><th id="15">15</th><td><i> *</i></td></tr>
<tr><th id="16">16</th><td><i> * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</i></td></tr>
<tr><th id="17">17</th><td><i> * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</i></td></tr>
<tr><th id="18">18</th><td><i> * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL</i></td></tr>
<tr><th id="19">19</th><td><i> * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</i></td></tr>
<tr><th id="20">20</th><td><i> * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</i></td></tr>
<tr><th id="21">21</th><td><i> * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</i></td></tr>
<tr><th id="22">22</th><td><i> * THE SOFTWARE.</i></td></tr>
<tr><th id="23">23</th><td><i> */</i></td></tr>
<tr><th id="24">24</th><td><u>#include <a href="../../include/qemu/osdep.h.html">"qemu/osdep.h"</a></u></td></tr>
<tr><th id="25">25</th><td><u>#include <a href="../../include/hw/hw.h.html">"hw/hw.h"</a></u></td></tr>
<tr><th id="26">26</th><td><u>#include <a href="../../include/hw/isa/isa.h.html">"hw/isa/isa.h"</a></u></td></tr>
<tr><th id="27">27</th><td><u>#include <a href="../../include/hw/isa/i8257.h.html">"hw/isa/i8257.h"</a></u></td></tr>
<tr><th id="28">28</th><td><u>#include <a href="../../include/qemu/main-loop.h.html">"qemu/main-loop.h"</a></u></td></tr>
<tr><th id="29">29</th><td><u>#include <a href="trace.h.html">"trace.h"</a></u></td></tr>
<tr><th id="30">30</th><td></td></tr>
<tr><th id="31">31</th><td><u>#define <dfn class="macro" id="_M/I8257" data-ref="_M/I8257">I8257</dfn>(obj) \</u></td></tr>
<tr><th id="32">32</th><td><u>    OBJECT_CHECK(<a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a>, (obj), TYPE_I8257)</u></td></tr>
<tr><th id="33">33</th><td></td></tr>
<tr><th id="34">34</th><td><i>/* #define DEBUG_DMA */</i></td></tr>
<tr><th id="35">35</th><td></td></tr>
<tr><th id="36">36</th><td><u>#define <dfn class="macro" id="_M/dolog" data-ref="_M/dolog">dolog</dfn>(...) <a class="ref" href="../../../include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf">fprintf</a> (stderr, "dma: " __VA_ARGS__)</u></td></tr>
<tr><th id="37">37</th><td><u>#<span data-ppcond="37">ifdef</span> <span class="macro" data-ref="_M/DEBUG_DMA">DEBUG_DMA</span></u></td></tr>
<tr><th id="38">38</th><td><u>#define linfo(...) fprintf (stderr, "dma: " __VA_ARGS__)</u></td></tr>
<tr><th id="39">39</th><td><u>#define ldebug(...) fprintf (stderr, "dma: " __VA_ARGS__)</u></td></tr>
<tr><th id="40">40</th><td><u>#<span data-ppcond="37">else</span></u></td></tr>
<tr><th id="41">41</th><td><u>#define <dfn class="macro" id="_M/linfo" data-ref="_M/linfo">linfo</dfn>(...)</u></td></tr>
<tr><th id="42">42</th><td><u>#define <dfn class="macro" id="_M/ldebug" data-ref="_M/ldebug">ldebug</dfn>(...)</u></td></tr>
<tr><th id="43">43</th><td><u>#<span data-ppcond="37">endif</span></u></td></tr>
<tr><th id="44">44</th><td></td></tr>
<tr><th id="45">45</th><td><u>#define <dfn class="macro" id="_M/ADDR" data-ref="_M/ADDR">ADDR</dfn> 0</u></td></tr>
<tr><th id="46">46</th><td><u>#define <dfn class="macro" id="_M/COUNT" data-ref="_M/COUNT">COUNT</dfn> 1</u></td></tr>
<tr><th id="47">47</th><td></td></tr>
<tr><th id="48">48</th><td><b>enum</b> {</td></tr>
<tr><th id="49">49</th><td>    <dfn class="enum" id="CMD_MEMORY_TO_MEMORY" title='CMD_MEMORY_TO_MEMORY' data-ref="CMD_MEMORY_TO_MEMORY">CMD_MEMORY_TO_MEMORY</dfn> = <var>0x01</var>,</td></tr>
<tr><th id="50">50</th><td>    <dfn class="enum" id="CMD_FIXED_ADDRESS" title='CMD_FIXED_ADDRESS' data-ref="CMD_FIXED_ADDRESS">CMD_FIXED_ADDRESS</dfn>    = <var>0x02</var>,</td></tr>
<tr><th id="51">51</th><td>    <dfn class="enum" id="CMD_BLOCK_CONTROLLER" title='CMD_BLOCK_CONTROLLER' data-ref="CMD_BLOCK_CONTROLLER">CMD_BLOCK_CONTROLLER</dfn> = <var>0x04</var>,</td></tr>
<tr><th id="52">52</th><td>    <dfn class="enum" id="CMD_COMPRESSED_TIME" title='CMD_COMPRESSED_TIME' data-ref="CMD_COMPRESSED_TIME">CMD_COMPRESSED_TIME</dfn>  = <var>0x08</var>,</td></tr>
<tr><th id="53">53</th><td>    <dfn class="enum" id="CMD_CYCLIC_PRIORITY" title='CMD_CYCLIC_PRIORITY' data-ref="CMD_CYCLIC_PRIORITY">CMD_CYCLIC_PRIORITY</dfn>  = <var>0x10</var>,</td></tr>
<tr><th id="54">54</th><td>    <dfn class="enum" id="CMD_EXTENDED_WRITE" title='CMD_EXTENDED_WRITE' data-ref="CMD_EXTENDED_WRITE">CMD_EXTENDED_WRITE</dfn>   = <var>0x20</var>,</td></tr>
<tr><th id="55">55</th><td>    <dfn class="enum" id="CMD_LOW_DREQ" title='CMD_LOW_DREQ' data-ref="CMD_LOW_DREQ">CMD_LOW_DREQ</dfn>         = <var>0x40</var>,</td></tr>
<tr><th id="56">56</th><td>    <dfn class="enum" id="CMD_LOW_DACK" title='CMD_LOW_DACK' data-ref="CMD_LOW_DACK">CMD_LOW_DACK</dfn>         = <var>0x80</var>,</td></tr>
<tr><th id="57">57</th><td>    <dfn class="enum" id="CMD_NOT_SUPPORTED" title='CMD_NOT_SUPPORTED' data-ref="CMD_NOT_SUPPORTED">CMD_NOT_SUPPORTED</dfn>    = <a class="enum" href="#CMD_MEMORY_TO_MEMORY" title='CMD_MEMORY_TO_MEMORY' data-ref="CMD_MEMORY_TO_MEMORY">CMD_MEMORY_TO_MEMORY</a> | <a class="enum" href="#CMD_FIXED_ADDRESS" title='CMD_FIXED_ADDRESS' data-ref="CMD_FIXED_ADDRESS">CMD_FIXED_ADDRESS</a></td></tr>
<tr><th id="58">58</th><td>    | <a class="enum" href="#CMD_COMPRESSED_TIME" title='CMD_COMPRESSED_TIME' data-ref="CMD_COMPRESSED_TIME">CMD_COMPRESSED_TIME</a> | <a class="enum" href="#CMD_CYCLIC_PRIORITY" title='CMD_CYCLIC_PRIORITY' data-ref="CMD_CYCLIC_PRIORITY">CMD_CYCLIC_PRIORITY</a> | <a class="enum" href="#CMD_EXTENDED_WRITE" title='CMD_EXTENDED_WRITE' data-ref="CMD_EXTENDED_WRITE">CMD_EXTENDED_WRITE</a></td></tr>
<tr><th id="59">59</th><td>    | <a class="enum" href="#CMD_LOW_DREQ" title='CMD_LOW_DREQ' data-ref="CMD_LOW_DREQ">CMD_LOW_DREQ</a> | <a class="enum" href="#CMD_LOW_DACK" title='CMD_LOW_DACK' data-ref="CMD_LOW_DACK">CMD_LOW_DACK</a></td></tr>
<tr><th id="60">60</th><td></td></tr>
<tr><th id="61">61</th><td>};</td></tr>
<tr><th id="62">62</th><td></td></tr>
<tr><th id="63">63</th><td><em>static</em> <em>void</em> <a class="tu decl" href="#i8257_dma_run" title='i8257_dma_run' data-type='void i8257_dma_run(void * opaque)' data-ref="i8257_dma_run">i8257_dma_run</a>(<em>void</em> *<dfn class="local col2 decl" id="92opaque" title='opaque' data-type='void *' data-ref="92opaque">opaque</dfn>);</td></tr>
<tr><th id="64">64</th><td></td></tr>
<tr><th id="65">65</th><td><em>static</em> <em>const</em> <em>int</em> <dfn class="tu decl def" id="channels" title='channels' data-type='const int [8]' data-ref="channels">channels</dfn>[<var>8</var>] = {-<var>1</var>, <var>2</var>, <var>3</var>, <var>1</var>, -<var>1</var>, -<var>1</var>, -<var>1</var>, <var>0</var>};</td></tr>
<tr><th id="66">66</th><td></td></tr>
<tr><th id="67">67</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="i8257_write_page" title='i8257_write_page' data-type='void i8257_write_page(void * opaque, uint32_t nport, uint32_t data)' data-ref="i8257_write_page">i8257_write_page</dfn>(<em>void</em> *<dfn class="local col3 decl" id="93opaque" title='opaque' data-type='void *' data-ref="93opaque">opaque</dfn>, <a class="typedef" href="../../../include/stdint.h.html#uint32_t" title='uint32_t' data-type='unsigned int' data-ref="uint32_t">uint32_t</a> <dfn class="local col4 decl" id="94nport" title='nport' data-type='uint32_t' data-ref="94nport">nport</dfn>, <a class="typedef" href="../../../include/stdint.h.html#uint32_t" title='uint32_t' data-type='unsigned int' data-ref="uint32_t">uint32_t</a> <dfn class="local col5 decl" id="95data" title='data' data-type='uint32_t' data-ref="95data">data</dfn>)</td></tr>
<tr><th id="68">68</th><td>{</td></tr>
<tr><th id="69">69</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col6 decl" id="96d" title='d' data-type='I8257State *' data-ref="96d">d</dfn> = <a class="local col3 ref" href="#93opaque" title='opaque' data-ref="93opaque">opaque</a>;</td></tr>
<tr><th id="70">70</th><td>    <em>int</em> <dfn class="local col7 decl" id="97ichan" title='ichan' data-type='int' data-ref="97ichan">ichan</dfn>;</td></tr>
<tr><th id="71">71</th><td></td></tr>
<tr><th id="72">72</th><td>    <a class="local col7 ref" href="#97ichan" title='ichan' data-ref="97ichan">ichan</a> = <a class="tu ref" href="#channels" title='channels' data-use='r' data-ref="channels">channels</a>[<a class="local col4 ref" href="#94nport" title='nport' data-ref="94nport">nport</a> &amp; <var>7</var>];</td></tr>
<tr><th id="73">73</th><td>    <b>if</b> (-<var>1</var> == <a class="local col7 ref" href="#97ichan" title='ichan' data-ref="97ichan">ichan</a>) {</td></tr>
<tr><th id="74">74</th><td>        <a class="macro" href="#36" title="fprintf (stderr, &quot;dma: &quot; &quot;invalid channel %#x %#x\n&quot;, nport, data)" data-ref="_M/dolog">dolog</a> (<q>"invalid channel %#x %#x\n"</q>, <a class="local col4 ref" href="#94nport" title='nport' data-ref="94nport">nport</a>, <a class="local col5 ref" href="#95data" title='data' data-ref="95data">data</a>);</td></tr>
<tr><th id="75">75</th><td>        <b>return</b>;</td></tr>
<tr><th id="76">76</th><td>    }</td></tr>
<tr><th id="77">77</th><td>    <a class="local col6 ref" href="#96d" title='d' data-ref="96d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a>[<a class="local col7 ref" href="#97ichan" title='ichan' data-ref="97ichan">ichan</a>].<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::page" title='I8257Regs::page' data-ref="I8257Regs::page">page</a> = <a class="local col5 ref" href="#95data" title='data' data-ref="95data">data</a>;</td></tr>
<tr><th id="78">78</th><td>}</td></tr>
<tr><th id="79">79</th><td></td></tr>
<tr><th id="80">80</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="i8257_write_pageh" title='i8257_write_pageh' data-type='void i8257_write_pageh(void * opaque, uint32_t nport, uint32_t data)' data-ref="i8257_write_pageh">i8257_write_pageh</dfn>(<em>void</em> *<dfn class="local col8 decl" id="98opaque" title='opaque' data-type='void *' data-ref="98opaque">opaque</dfn>, <a class="typedef" href="../../../include/stdint.h.html#uint32_t" title='uint32_t' data-type='unsigned int' data-ref="uint32_t">uint32_t</a> <dfn class="local col9 decl" id="99nport" title='nport' data-type='uint32_t' data-ref="99nport">nport</dfn>, <a class="typedef" href="../../../include/stdint.h.html#uint32_t" title='uint32_t' data-type='unsigned int' data-ref="uint32_t">uint32_t</a> <dfn class="local col0 decl" id="100data" title='data' data-type='uint32_t' data-ref="100data">data</dfn>)</td></tr>
<tr><th id="81">81</th><td>{</td></tr>
<tr><th id="82">82</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col1 decl" id="101d" title='d' data-type='I8257State *' data-ref="101d">d</dfn> = <a class="local col8 ref" href="#98opaque" title='opaque' data-ref="98opaque">opaque</a>;</td></tr>
<tr><th id="83">83</th><td>    <em>int</em> <dfn class="local col2 decl" id="102ichan" title='ichan' data-type='int' data-ref="102ichan">ichan</dfn>;</td></tr>
<tr><th id="84">84</th><td></td></tr>
<tr><th id="85">85</th><td>    <a class="local col2 ref" href="#102ichan" title='ichan' data-ref="102ichan">ichan</a> = <a class="tu ref" href="#channels" title='channels' data-use='r' data-ref="channels">channels</a>[<a class="local col9 ref" href="#99nport" title='nport' data-ref="99nport">nport</a> &amp; <var>7</var>];</td></tr>
<tr><th id="86">86</th><td>    <b>if</b> (-<var>1</var> == <a class="local col2 ref" href="#102ichan" title='ichan' data-ref="102ichan">ichan</a>) {</td></tr>
<tr><th id="87">87</th><td>        <a class="macro" href="#36" title="fprintf (stderr, &quot;dma: &quot; &quot;invalid channel %#x %#x\n&quot;, nport, data)" data-ref="_M/dolog">dolog</a> (<q>"invalid channel %#x %#x\n"</q>, <a class="local col9 ref" href="#99nport" title='nport' data-ref="99nport">nport</a>, <a class="local col0 ref" href="#100data" title='data' data-ref="100data">data</a>);</td></tr>
<tr><th id="88">88</th><td>        <b>return</b>;</td></tr>
<tr><th id="89">89</th><td>    }</td></tr>
<tr><th id="90">90</th><td>    <a class="local col1 ref" href="#101d" title='d' data-ref="101d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a>[<a class="local col2 ref" href="#102ichan" title='ichan' data-ref="102ichan">ichan</a>].<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::pageh" title='I8257Regs::pageh' data-ref="I8257Regs::pageh">pageh</a> = <a class="local col0 ref" href="#100data" title='data' data-ref="100data">data</a>;</td></tr>
<tr><th id="91">91</th><td>}</td></tr>
<tr><th id="92">92</th><td></td></tr>
<tr><th id="93">93</th><td><em>static</em> <a class="typedef" href="../../../include/stdint.h.html#uint32_t" title='uint32_t' data-type='unsigned int' data-ref="uint32_t">uint32_t</a> <dfn class="tu decl def" id="i8257_read_page" title='i8257_read_page' data-type='uint32_t i8257_read_page(void * opaque, uint32_t nport)' data-ref="i8257_read_page">i8257_read_page</dfn>(<em>void</em> *<dfn class="local col3 decl" id="103opaque" title='opaque' data-type='void *' data-ref="103opaque">opaque</dfn>, <a class="typedef" href="../../../include/stdint.h.html#uint32_t" title='uint32_t' data-type='unsigned int' data-ref="uint32_t">uint32_t</a> <dfn class="local col4 decl" id="104nport" title='nport' data-type='uint32_t' data-ref="104nport">nport</dfn>)</td></tr>
<tr><th id="94">94</th><td>{</td></tr>
<tr><th id="95">95</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col5 decl" id="105d" title='d' data-type='I8257State *' data-ref="105d">d</dfn> = <a class="local col3 ref" href="#103opaque" title='opaque' data-ref="103opaque">opaque</a>;</td></tr>
<tr><th id="96">96</th><td>    <em>int</em> <dfn class="local col6 decl" id="106ichan" title='ichan' data-type='int' data-ref="106ichan">ichan</dfn>;</td></tr>
<tr><th id="97">97</th><td></td></tr>
<tr><th id="98">98</th><td>    <a class="local col6 ref" href="#106ichan" title='ichan' data-ref="106ichan">ichan</a> = <a class="tu ref" href="#channels" title='channels' data-use='r' data-ref="channels">channels</a>[<a class="local col4 ref" href="#104nport" title='nport' data-ref="104nport">nport</a> &amp; <var>7</var>];</td></tr>
<tr><th id="99">99</th><td>    <b>if</b> (-<var>1</var> == <a class="local col6 ref" href="#106ichan" title='ichan' data-ref="106ichan">ichan</a>) {</td></tr>
<tr><th id="100">100</th><td>        <a class="macro" href="#36" title="fprintf (stderr, &quot;dma: &quot; &quot;invalid channel read %#x\n&quot;, nport)" data-ref="_M/dolog">dolog</a> (<q>"invalid channel read %#x\n"</q>, <a class="local col4 ref" href="#104nport" title='nport' data-ref="104nport">nport</a>);</td></tr>
<tr><th id="101">101</th><td>        <b>return</b> <var>0</var>;</td></tr>
<tr><th id="102">102</th><td>    }</td></tr>
<tr><th id="103">103</th><td>    <b>return</b> <a class="local col5 ref" href="#105d" title='d' data-ref="105d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a>[<a class="local col6 ref" href="#106ichan" title='ichan' data-ref="106ichan">ichan</a>].<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::page" title='I8257Regs::page' data-ref="I8257Regs::page">page</a>;</td></tr>
<tr><th id="104">104</th><td>}</td></tr>
<tr><th id="105">105</th><td></td></tr>
<tr><th id="106">106</th><td><em>static</em> <a class="typedef" href="../../../include/stdint.h.html#uint32_t" title='uint32_t' data-type='unsigned int' data-ref="uint32_t">uint32_t</a> <dfn class="tu decl def" id="i8257_read_pageh" title='i8257_read_pageh' data-type='uint32_t i8257_read_pageh(void * opaque, uint32_t nport)' data-ref="i8257_read_pageh">i8257_read_pageh</dfn>(<em>void</em> *<dfn class="local col7 decl" id="107opaque" title='opaque' data-type='void *' data-ref="107opaque">opaque</dfn>, <a class="typedef" href="../../../include/stdint.h.html#uint32_t" title='uint32_t' data-type='unsigned int' data-ref="uint32_t">uint32_t</a> <dfn class="local col8 decl" id="108nport" title='nport' data-type='uint32_t' data-ref="108nport">nport</dfn>)</td></tr>
<tr><th id="107">107</th><td>{</td></tr>
<tr><th id="108">108</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col9 decl" id="109d" title='d' data-type='I8257State *' data-ref="109d">d</dfn> = <a class="local col7 ref" href="#107opaque" title='opaque' data-ref="107opaque">opaque</a>;</td></tr>
<tr><th id="109">109</th><td>    <em>int</em> <dfn class="local col0 decl" id="110ichan" title='ichan' data-type='int' data-ref="110ichan">ichan</dfn>;</td></tr>
<tr><th id="110">110</th><td></td></tr>
<tr><th id="111">111</th><td>    <a class="local col0 ref" href="#110ichan" title='ichan' data-ref="110ichan">ichan</a> = <a class="tu ref" href="#channels" title='channels' data-use='r' data-ref="channels">channels</a>[<a class="local col8 ref" href="#108nport" title='nport' data-ref="108nport">nport</a> &amp; <var>7</var>];</td></tr>
<tr><th id="112">112</th><td>    <b>if</b> (-<var>1</var> == <a class="local col0 ref" href="#110ichan" title='ichan' data-ref="110ichan">ichan</a>) {</td></tr>
<tr><th id="113">113</th><td>        <a class="macro" href="#36" title="fprintf (stderr, &quot;dma: &quot; &quot;invalid channel read %#x\n&quot;, nport)" data-ref="_M/dolog">dolog</a> (<q>"invalid channel read %#x\n"</q>, <a class="local col8 ref" href="#108nport" title='nport' data-ref="108nport">nport</a>);</td></tr>
<tr><th id="114">114</th><td>        <b>return</b> <var>0</var>;</td></tr>
<tr><th id="115">115</th><td>    }</td></tr>
<tr><th id="116">116</th><td>    <b>return</b> <a class="local col9 ref" href="#109d" title='d' data-ref="109d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a>[<a class="local col0 ref" href="#110ichan" title='ichan' data-ref="110ichan">ichan</a>].<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::pageh" title='I8257Regs::pageh' data-ref="I8257Regs::pageh">pageh</a>;</td></tr>
<tr><th id="117">117</th><td>}</td></tr>
<tr><th id="118">118</th><td></td></tr>
<tr><th id="119">119</th><td><em>static</em> <b>inline</b> <em>void</em> <dfn class="tu decl def" id="i8257_init_chan" title='i8257_init_chan' data-type='void i8257_init_chan(I8257State * d, int ichan)' data-ref="i8257_init_chan">i8257_init_chan</dfn>(<a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col1 decl" id="111d" title='d' data-type='I8257State *' data-ref="111d">d</dfn>, <em>int</em> <dfn class="local col2 decl" id="112ichan" title='ichan' data-type='int' data-ref="112ichan">ichan</dfn>)</td></tr>
<tr><th id="120">120</th><td>{</td></tr>
<tr><th id="121">121</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a> *<dfn class="local col3 decl" id="113r" title='r' data-type='I8257Regs *' data-ref="113r">r</dfn>;</td></tr>
<tr><th id="122">122</th><td></td></tr>
<tr><th id="123">123</th><td>    <a class="local col3 ref" href="#113r" title='r' data-ref="113r">r</a> = <a class="local col1 ref" href="#111d" title='d' data-ref="111d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a> + <a class="local col2 ref" href="#112ichan" title='ichan' data-ref="112ichan">ichan</a>;</td></tr>
<tr><th id="124">124</th><td>    <a class="local col3 ref" href="#113r" title='r' data-ref="113r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::now" title='I8257Regs::now' data-ref="I8257Regs::now">now</a>[<a class="macro" href="#45" title="0" data-ref="_M/ADDR">ADDR</a>] = <a class="local col3 ref" href="#113r" title='r' data-ref="113r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::base" title='I8257Regs::base' data-ref="I8257Regs::base">base</a>[<a class="macro" href="#45" title="0" data-ref="_M/ADDR">ADDR</a>] &lt;&lt; <a class="local col1 ref" href="#111d" title='d' data-ref="111d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dshift" title='I8257State::dshift' data-ref="I8257State::dshift">dshift</a>;</td></tr>
<tr><th id="125">125</th><td>    <a class="local col3 ref" href="#113r" title='r' data-ref="113r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::now" title='I8257Regs::now' data-ref="I8257Regs::now">now</a>[<a class="macro" href="#46" title="1" data-ref="_M/COUNT">COUNT</a>] = <var>0</var>;</td></tr>
<tr><th id="126">126</th><td>}</td></tr>
<tr><th id="127">127</th><td></td></tr>
<tr><th id="128">128</th><td><em>static</em> <b>inline</b> <em>int</em> <dfn class="tu decl def" id="i8257_getff" title='i8257_getff' data-type='int i8257_getff(I8257State * d)' data-ref="i8257_getff">i8257_getff</dfn>(<a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col4 decl" id="114d" title='d' data-type='I8257State *' data-ref="114d">d</dfn>)</td></tr>
<tr><th id="129">129</th><td>{</td></tr>
<tr><th id="130">130</th><td>    <em>int</em> <dfn class="local col5 decl" id="115ff" title='ff' data-type='int' data-ref="115ff">ff</dfn>;</td></tr>
<tr><th id="131">131</th><td></td></tr>
<tr><th id="132">132</th><td>    <a class="local col5 ref" href="#115ff" title='ff' data-ref="115ff">ff</a> = <a class="local col4 ref" href="#114d" title='d' data-ref="114d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::flip_flop" title='I8257State::flip_flop' data-ref="I8257State::flip_flop">flip_flop</a>;</td></tr>
<tr><th id="133">133</th><td>    <a class="local col4 ref" href="#114d" title='d' data-ref="114d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::flip_flop" title='I8257State::flip_flop' data-ref="I8257State::flip_flop">flip_flop</a> = !<a class="local col5 ref" href="#115ff" title='ff' data-ref="115ff">ff</a>;</td></tr>
<tr><th id="134">134</th><td>    <b>return</b> <a class="local col5 ref" href="#115ff" title='ff' data-ref="115ff">ff</a>;</td></tr>
<tr><th id="135">135</th><td>}</td></tr>
<tr><th id="136">136</th><td></td></tr>
<tr><th id="137">137</th><td><em>static</em> <a class="typedef" href="../../../include/stdint.h.html#uint64_t" title='uint64_t' data-type='unsigned long' data-ref="uint64_t">uint64_t</a> <dfn class="tu decl def" id="i8257_read_chan" title='i8257_read_chan' data-type='uint64_t i8257_read_chan(void * opaque, hwaddr nport, unsigned int size)' data-ref="i8257_read_chan">i8257_read_chan</dfn>(<em>void</em> *<dfn class="local col6 decl" id="116opaque" title='opaque' data-type='void *' data-ref="116opaque">opaque</dfn>, <a class="typedef" href="../../include/exec/hwaddr.h.html#hwaddr" title='hwaddr' data-type='uint64_t' data-ref="hwaddr">hwaddr</a> <dfn class="local col7 decl" id="117nport" title='nport' data-type='hwaddr' data-ref="117nport">nport</dfn>, <em>unsigned</em> <dfn class="local col8 decl" id="118size" title='size' data-type='unsigned int' data-ref="118size">size</dfn>)</td></tr>
<tr><th id="138">138</th><td>{</td></tr>
<tr><th id="139">139</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col9 decl" id="119d" title='d' data-type='I8257State *' data-ref="119d">d</dfn> = <a class="local col6 ref" href="#116opaque" title='opaque' data-ref="116opaque">opaque</a>;</td></tr>
<tr><th id="140">140</th><td>    <em>int</em> <dfn class="local col0 decl" id="120ichan" title='ichan' data-type='int' data-ref="120ichan">ichan</dfn>, <dfn class="local col1 decl" id="121nreg" title='nreg' data-type='int' data-ref="121nreg">nreg</dfn>, <dfn class="local col2 decl" id="122iport" title='iport' data-type='int' data-ref="122iport">iport</dfn>, <dfn class="local col3 decl" id="123ff" title='ff' data-type='int' data-ref="123ff">ff</dfn>, <dfn class="local col4 decl" id="124val" title='val' data-type='int' data-ref="124val">val</dfn>, <dfn class="local col5 decl" id="125dir" title='dir' data-type='int' data-ref="125dir">dir</dfn>;</td></tr>
<tr><th id="141">141</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a> *<dfn class="local col6 decl" id="126r" title='r' data-type='I8257Regs *' data-ref="126r">r</dfn>;</td></tr>
<tr><th id="142">142</th><td></td></tr>
<tr><th id="143">143</th><td>    <a class="local col2 ref" href="#122iport" title='iport' data-ref="122iport">iport</a> = (<a class="local col7 ref" href="#117nport" title='nport' data-ref="117nport">nport</a> &gt;&gt; <a class="local col9 ref" href="#119d" title='d' data-ref="119d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dshift" title='I8257State::dshift' data-ref="I8257State::dshift">dshift</a>) &amp; <var>0x0f</var>;</td></tr>
<tr><th id="144">144</th><td>    <a class="local col0 ref" href="#120ichan" title='ichan' data-ref="120ichan">ichan</a> = <a class="local col2 ref" href="#122iport" title='iport' data-ref="122iport">iport</a> &gt;&gt; <var>1</var>;</td></tr>
<tr><th id="145">145</th><td>    <a class="local col1 ref" href="#121nreg" title='nreg' data-ref="121nreg">nreg</a> = <a class="local col2 ref" href="#122iport" title='iport' data-ref="122iport">iport</a> &amp; <var>1</var>;</td></tr>
<tr><th id="146">146</th><td>    <a class="local col6 ref" href="#126r" title='r' data-ref="126r">r</a> = <a class="local col9 ref" href="#119d" title='d' data-ref="119d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a> + <a class="local col0 ref" href="#120ichan" title='ichan' data-ref="120ichan">ichan</a>;</td></tr>
<tr><th id="147">147</th><td></td></tr>
<tr><th id="148">148</th><td>    <a class="local col5 ref" href="#125dir" title='dir' data-ref="125dir">dir</a> = ((<a class="local col6 ref" href="#126r" title='r' data-ref="126r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::mode" title='I8257Regs::mode' data-ref="I8257Regs::mode">mode</a> &gt;&gt; <var>5</var>) &amp; <var>1</var>) ? -<var>1</var> : <var>1</var>;</td></tr>
<tr><th id="149">149</th><td>    <a class="local col3 ref" href="#123ff" title='ff' data-ref="123ff">ff</a> = <a class="tu ref" href="#i8257_getff" title='i8257_getff' data-use='c' data-ref="i8257_getff">i8257_getff</a>(<a class="local col9 ref" href="#119d" title='d' data-ref="119d">d</a>);</td></tr>
<tr><th id="150">150</th><td>    <b>if</b> (<a class="local col1 ref" href="#121nreg" title='nreg' data-ref="121nreg">nreg</a>)</td></tr>
<tr><th id="151">151</th><td>        <a class="local col4 ref" href="#124val" title='val' data-ref="124val">val</a> = (<a class="local col6 ref" href="#126r" title='r' data-ref="126r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::base" title='I8257Regs::base' data-ref="I8257Regs::base">base</a>[<a class="macro" href="#46" title="1" data-ref="_M/COUNT">COUNT</a>] &lt;&lt; <a class="local col9 ref" href="#119d" title='d' data-ref="119d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dshift" title='I8257State::dshift' data-ref="I8257State::dshift">dshift</a>) - <a class="local col6 ref" href="#126r" title='r' data-ref="126r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::now" title='I8257Regs::now' data-ref="I8257Regs::now">now</a>[<a class="macro" href="#46" title="1" data-ref="_M/COUNT">COUNT</a>];</td></tr>
<tr><th id="152">152</th><td>    <b>else</b></td></tr>
<tr><th id="153">153</th><td>        <a class="local col4 ref" href="#124val" title='val' data-ref="124val">val</a> = <a class="local col6 ref" href="#126r" title='r' data-ref="126r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::now" title='I8257Regs::now' data-ref="I8257Regs::now">now</a>[<a class="macro" href="#45" title="0" data-ref="_M/ADDR">ADDR</a>] + <a class="local col6 ref" href="#126r" title='r' data-ref="126r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::now" title='I8257Regs::now' data-ref="I8257Regs::now">now</a>[<a class="macro" href="#46" title="1" data-ref="_M/COUNT">COUNT</a>] * <a class="local col5 ref" href="#125dir" title='dir' data-ref="125dir">dir</a>;</td></tr>
<tr><th id="154">154</th><td></td></tr>
<tr><th id="155">155</th><td>    <a class="macro" href="#42" title="" data-ref="_M/ldebug">ldebug</a> (<q>"read_chan %#x -&gt; %d\n"</q>, iport, val);</td></tr>
<tr><th id="156">156</th><td>    <b>return</b> (<a class="local col4 ref" href="#124val" title='val' data-ref="124val">val</a> &gt;&gt; (<a class="local col9 ref" href="#119d" title='d' data-ref="119d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dshift" title='I8257State::dshift' data-ref="I8257State::dshift">dshift</a> + (<a class="local col3 ref" href="#123ff" title='ff' data-ref="123ff">ff</a> &lt;&lt; <var>3</var>))) &amp; <var>0xff</var>;</td></tr>
<tr><th id="157">157</th><td>}</td></tr>
<tr><th id="158">158</th><td></td></tr>
<tr><th id="159">159</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="i8257_write_chan" title='i8257_write_chan' data-type='void i8257_write_chan(void * opaque, hwaddr nport, uint64_t data, unsigned int size)' data-ref="i8257_write_chan">i8257_write_chan</dfn>(<em>void</em> *<dfn class="local col7 decl" id="127opaque" title='opaque' data-type='void *' data-ref="127opaque">opaque</dfn>, <a class="typedef" href="../../include/exec/hwaddr.h.html#hwaddr" title='hwaddr' data-type='uint64_t' data-ref="hwaddr">hwaddr</a> <dfn class="local col8 decl" id="128nport" title='nport' data-type='hwaddr' data-ref="128nport">nport</dfn>, <a class="typedef" href="../../../include/stdint.h.html#uint64_t" title='uint64_t' data-type='unsigned long' data-ref="uint64_t">uint64_t</a> <dfn class="local col9 decl" id="129data" title='data' data-type='uint64_t' data-ref="129data">data</dfn>,</td></tr>
<tr><th id="160">160</th><td>                             <em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="130size" title='size' data-type='unsigned int' data-ref="130size">size</dfn>)</td></tr>
<tr><th id="161">161</th><td>{</td></tr>
<tr><th id="162">162</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col1 decl" id="131d" title='d' data-type='I8257State *' data-ref="131d">d</dfn> = <a class="local col7 ref" href="#127opaque" title='opaque' data-ref="127opaque">opaque</a>;</td></tr>
<tr><th id="163">163</th><td>    <em>int</em> <dfn class="local col2 decl" id="132iport" title='iport' data-type='int' data-ref="132iport">iport</dfn>, <dfn class="local col3 decl" id="133ichan" title='ichan' data-type='int' data-ref="133ichan">ichan</dfn>, <dfn class="local col4 decl" id="134nreg" title='nreg' data-type='int' data-ref="134nreg">nreg</dfn>;</td></tr>
<tr><th id="164">164</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a> *<dfn class="local col5 decl" id="135r" title='r' data-type='I8257Regs *' data-ref="135r">r</dfn>;</td></tr>
<tr><th id="165">165</th><td></td></tr>
<tr><th id="166">166</th><td>    <a class="local col2 ref" href="#132iport" title='iport' data-ref="132iport">iport</a> = (<a class="local col8 ref" href="#128nport" title='nport' data-ref="128nport">nport</a> &gt;&gt; <a class="local col1 ref" href="#131d" title='d' data-ref="131d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dshift" title='I8257State::dshift' data-ref="I8257State::dshift">dshift</a>) &amp; <var>0x0f</var>;</td></tr>
<tr><th id="167">167</th><td>    <a class="local col3 ref" href="#133ichan" title='ichan' data-ref="133ichan">ichan</a> = <a class="local col2 ref" href="#132iport" title='iport' data-ref="132iport">iport</a> &gt;&gt; <var>1</var>;</td></tr>
<tr><th id="168">168</th><td>    <a class="local col4 ref" href="#134nreg" title='nreg' data-ref="134nreg">nreg</a> = <a class="local col2 ref" href="#132iport" title='iport' data-ref="132iport">iport</a> &amp; <var>1</var>;</td></tr>
<tr><th id="169">169</th><td>    <a class="local col5 ref" href="#135r" title='r' data-ref="135r">r</a> = <a class="local col1 ref" href="#131d" title='d' data-ref="131d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a> + <a class="local col3 ref" href="#133ichan" title='ichan' data-ref="133ichan">ichan</a>;</td></tr>
<tr><th id="170">170</th><td>    <b>if</b> (<a class="tu ref" href="#i8257_getff" title='i8257_getff' data-use='c' data-ref="i8257_getff">i8257_getff</a>(<a class="local col1 ref" href="#131d" title='d' data-ref="131d">d</a>)) {</td></tr>
<tr><th id="171">171</th><td>        <a class="local col5 ref" href="#135r" title='r' data-ref="135r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::base" title='I8257Regs::base' data-ref="I8257Regs::base">base</a>[<a class="local col4 ref" href="#134nreg" title='nreg' data-ref="134nreg">nreg</a>] = (<a class="local col5 ref" href="#135r" title='r' data-ref="135r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::base" title='I8257Regs::base' data-ref="I8257Regs::base">base</a>[<a class="local col4 ref" href="#134nreg" title='nreg' data-ref="134nreg">nreg</a>] &amp; <var>0xff</var>) | ((<a class="local col9 ref" href="#129data" title='data' data-ref="129data">data</a> &lt;&lt; <var>8</var>) &amp; <var>0xff00</var>);</td></tr>
<tr><th id="172">172</th><td>        <a class="tu ref" href="#i8257_init_chan" title='i8257_init_chan' data-use='c' data-ref="i8257_init_chan">i8257_init_chan</a>(<a class="local col1 ref" href="#131d" title='d' data-ref="131d">d</a>, <a class="local col3 ref" href="#133ichan" title='ichan' data-ref="133ichan">ichan</a>);</td></tr>
<tr><th id="173">173</th><td>    } <b>else</b> {</td></tr>
<tr><th id="174">174</th><td>        <a class="local col5 ref" href="#135r" title='r' data-ref="135r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::base" title='I8257Regs::base' data-ref="I8257Regs::base">base</a>[<a class="local col4 ref" href="#134nreg" title='nreg' data-ref="134nreg">nreg</a>] = (<a class="local col5 ref" href="#135r" title='r' data-ref="135r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::base" title='I8257Regs::base' data-ref="I8257Regs::base">base</a>[<a class="local col4 ref" href="#134nreg" title='nreg' data-ref="134nreg">nreg</a>] &amp; <var>0xff00</var>) | (<a class="local col9 ref" href="#129data" title='data' data-ref="129data">data</a> &amp; <var>0xff</var>);</td></tr>
<tr><th id="175">175</th><td>    }</td></tr>
<tr><th id="176">176</th><td>}</td></tr>
<tr><th id="177">177</th><td></td></tr>
<tr><th id="178">178</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="i8257_write_cont" title='i8257_write_cont' data-type='void i8257_write_cont(void * opaque, hwaddr nport, uint64_t data, unsigned int size)' data-ref="i8257_write_cont">i8257_write_cont</dfn>(<em>void</em> *<dfn class="local col6 decl" id="136opaque" title='opaque' data-type='void *' data-ref="136opaque">opaque</dfn>, <a class="typedef" href="../../include/exec/hwaddr.h.html#hwaddr" title='hwaddr' data-type='uint64_t' data-ref="hwaddr">hwaddr</a> <dfn class="local col7 decl" id="137nport" title='nport' data-type='hwaddr' data-ref="137nport">nport</dfn>, <a class="typedef" href="../../../include/stdint.h.html#uint64_t" title='uint64_t' data-type='unsigned long' data-ref="uint64_t">uint64_t</a> <dfn class="local col8 decl" id="138data" title='data' data-type='uint64_t' data-ref="138data">data</dfn>,</td></tr>
<tr><th id="179">179</th><td>                             <em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="139size" title='size' data-type='unsigned int' data-ref="139size">size</dfn>)</td></tr>
<tr><th id="180">180</th><td>{</td></tr>
<tr><th id="181">181</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col0 decl" id="140d" title='d' data-type='I8257State *' data-ref="140d">d</dfn> = <a class="local col6 ref" href="#136opaque" title='opaque' data-ref="136opaque">opaque</a>;</td></tr>
<tr><th id="182">182</th><td>    <em>int</em> <dfn class="local col1 decl" id="141iport" title='iport' data-type='int' data-ref="141iport">iport</dfn>, <dfn class="local col2 decl" id="142ichan" title='ichan' data-type='int' data-ref="142ichan">ichan</dfn> = <var>0</var>;</td></tr>
<tr><th id="183">183</th><td></td></tr>
<tr><th id="184">184</th><td>    <a class="local col1 ref" href="#141iport" title='iport' data-ref="141iport">iport</a> = (<a class="local col7 ref" href="#137nport" title='nport' data-ref="137nport">nport</a> &gt;&gt; <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dshift" title='I8257State::dshift' data-ref="I8257State::dshift">dshift</a>) &amp; <var>0x0f</var>;</td></tr>
<tr><th id="185">185</th><td>    <b>switch</b> (<a class="local col1 ref" href="#141iport" title='iport' data-ref="141iport">iport</a>) {</td></tr>
<tr><th id="186">186</th><td>    <b>case</b> <var>0x00</var>:                  <i>/* command */</i></td></tr>
<tr><th id="187">187</th><td>        <b>if</b> ((<a class="local col8 ref" href="#138data" title='data' data-ref="138data">data</a> != <var>0</var>) &amp;&amp; (<a class="local col8 ref" href="#138data" title='data' data-ref="138data">data</a> &amp; <a class="enum" href="#CMD_NOT_SUPPORTED" title='CMD_NOT_SUPPORTED' data-ref="CMD_NOT_SUPPORTED">CMD_NOT_SUPPORTED</a>)) {</td></tr>
<tr><th id="188">188</th><td>            <a class="macro" href="#36" title="fprintf (stderr, &quot;dma: &quot; &quot;command %&quot;&quot;l&quot; &quot;x&quot;&quot; not supported\n&quot;, data)" data-ref="_M/dolog">dolog</a>(<q>"command %"</q><a class="macro" href="../../../include/inttypes.h.html#121" title="&quot;l&quot; &quot;x&quot;" data-ref="_M/PRIx64">PRIx64</a><q>" not supported\n"</q>, <a class="local col8 ref" href="#138data" title='data' data-ref="138data">data</a>);</td></tr>
<tr><th id="189">189</th><td>            <b>return</b>;</td></tr>
<tr><th id="190">190</th><td>        }</td></tr>
<tr><th id="191">191</th><td>        <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::command" title='I8257State::command' data-ref="I8257State::command">command</a> = <a class="local col8 ref" href="#138data" title='data' data-ref="138data">data</a>;</td></tr>
<tr><th id="192">192</th><td>        <b>break</b>;</td></tr>
<tr><th id="193">193</th><td></td></tr>
<tr><th id="194">194</th><td>    <b>case</b> <var>0x01</var>:</td></tr>
<tr><th id="195">195</th><td>        <a class="local col2 ref" href="#142ichan" title='ichan' data-ref="142ichan">ichan</a> = <a class="local col8 ref" href="#138data" title='data' data-ref="138data">data</a> &amp; <var>3</var>;</td></tr>
<tr><th id="196">196</th><td>        <b>if</b> (<a class="local col8 ref" href="#138data" title='data' data-ref="138data">data</a> &amp; <var>4</var>) {</td></tr>
<tr><th id="197">197</th><td>            <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::status" title='I8257State::status' data-ref="I8257State::status">status</a> |= <var>1</var> &lt;&lt; (<a class="local col2 ref" href="#142ichan" title='ichan' data-ref="142ichan">ichan</a> + <var>4</var>);</td></tr>
<tr><th id="198">198</th><td>        }</td></tr>
<tr><th id="199">199</th><td>        <b>else</b> {</td></tr>
<tr><th id="200">200</th><td>            <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::status" title='I8257State::status' data-ref="I8257State::status">status</a> &amp;= ~(<var>1</var> &lt;&lt; (<a class="local col2 ref" href="#142ichan" title='ichan' data-ref="142ichan">ichan</a> + <var>4</var>));</td></tr>
<tr><th id="201">201</th><td>        }</td></tr>
<tr><th id="202">202</th><td>        <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::status" title='I8257State::status' data-ref="I8257State::status">status</a> &amp;= ~(<var>1</var> &lt;&lt; <a class="local col2 ref" href="#142ichan" title='ichan' data-ref="142ichan">ichan</a>);</td></tr>
<tr><th id="203">203</th><td>        <a class="tu ref" href="#i8257_dma_run" title='i8257_dma_run' data-use='c' data-ref="i8257_dma_run">i8257_dma_run</a>(<a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>);</td></tr>
<tr><th id="204">204</th><td>        <b>break</b>;</td></tr>
<tr><th id="205">205</th><td></td></tr>
<tr><th id="206">206</th><td>    <b>case</b> <var>0x02</var>:                  <i>/* single mask */</i></td></tr>
<tr><th id="207">207</th><td>        <b>if</b> (<a class="local col8 ref" href="#138data" title='data' data-ref="138data">data</a> &amp; <var>4</var>)</td></tr>
<tr><th id="208">208</th><td>            <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::mask" title='I8257State::mask' data-ref="I8257State::mask">mask</a> |= <var>1</var> &lt;&lt; (<a class="local col8 ref" href="#138data" title='data' data-ref="138data">data</a> &amp; <var>3</var>);</td></tr>
<tr><th id="209">209</th><td>        <b>else</b></td></tr>
<tr><th id="210">210</th><td>            <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::mask" title='I8257State::mask' data-ref="I8257State::mask">mask</a> &amp;= ~(<var>1</var> &lt;&lt; (<a class="local col8 ref" href="#138data" title='data' data-ref="138data">data</a> &amp; <var>3</var>));</td></tr>
<tr><th id="211">211</th><td>        <a class="tu ref" href="#i8257_dma_run" title='i8257_dma_run' data-use='c' data-ref="i8257_dma_run">i8257_dma_run</a>(<a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>);</td></tr>
<tr><th id="212">212</th><td>        <b>break</b>;</td></tr>
<tr><th id="213">213</th><td></td></tr>
<tr><th id="214">214</th><td>    <b>case</b> <var>0x03</var>:                  <i>/* mode */</i></td></tr>
<tr><th id="215">215</th><td>        {</td></tr>
<tr><th id="216">216</th><td>            <a class="local col2 ref" href="#142ichan" title='ichan' data-ref="142ichan">ichan</a> = <a class="local col8 ref" href="#138data" title='data' data-ref="138data">data</a> &amp; <var>3</var>;</td></tr>
<tr><th id="217">217</th><td><u>#<span data-ppcond="217">ifdef</span> <span class="macro" data-ref="_M/DEBUG_DMA">DEBUG_DMA</span></u></td></tr>
<tr><th id="218">218</th><td>            {</td></tr>
<tr><th id="219">219</th><td>                <em>int</em> op, ai, dir, opmode;</td></tr>
<tr><th id="220">220</th><td>                op = (data &gt;&gt; <var>2</var>) &amp; <var>3</var>;</td></tr>
<tr><th id="221">221</th><td>                ai = (data &gt;&gt; <var>4</var>) &amp; <var>1</var>;</td></tr>
<tr><th id="222">222</th><td>                dir = (data &gt;&gt; <var>5</var>) &amp; <var>1</var>;</td></tr>
<tr><th id="223">223</th><td>                opmode = (data &gt;&gt; <var>6</var>) &amp; <var>3</var>;</td></tr>
<tr><th id="224">224</th><td></td></tr>
<tr><th id="225">225</th><td>                linfo (<q>"ichan %d, op %d, ai %d, dir %d, opmode %d\n"</q>,</td></tr>
<tr><th id="226">226</th><td>                       ichan, op, ai, dir, opmode);</td></tr>
<tr><th id="227">227</th><td>            }</td></tr>
<tr><th id="228">228</th><td><u>#<span data-ppcond="217">endif</span></u></td></tr>
<tr><th id="229">229</th><td>            <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a>[<a class="local col2 ref" href="#142ichan" title='ichan' data-ref="142ichan">ichan</a>].<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::mode" title='I8257Regs::mode' data-ref="I8257Regs::mode">mode</a> = <a class="local col8 ref" href="#138data" title='data' data-ref="138data">data</a>;</td></tr>
<tr><th id="230">230</th><td>            <b>break</b>;</td></tr>
<tr><th id="231">231</th><td>        }</td></tr>
<tr><th id="232">232</th><td></td></tr>
<tr><th id="233">233</th><td>    <b>case</b> <var>0x04</var>:                  <i>/* clear flip flop */</i></td></tr>
<tr><th id="234">234</th><td>        <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::flip_flop" title='I8257State::flip_flop' data-ref="I8257State::flip_flop">flip_flop</a> = <var>0</var>;</td></tr>
<tr><th id="235">235</th><td>        <b>break</b>;</td></tr>
<tr><th id="236">236</th><td></td></tr>
<tr><th id="237">237</th><td>    <b>case</b> <var>0x05</var>:                  <i>/* reset */</i></td></tr>
<tr><th id="238">238</th><td>        <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::flip_flop" title='I8257State::flip_flop' data-ref="I8257State::flip_flop">flip_flop</a> = <var>0</var>;</td></tr>
<tr><th id="239">239</th><td>        <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::mask" title='I8257State::mask' data-ref="I8257State::mask">mask</a> = ~<var>0</var>;</td></tr>
<tr><th id="240">240</th><td>        <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::status" title='I8257State::status' data-ref="I8257State::status">status</a> = <var>0</var>;</td></tr>
<tr><th id="241">241</th><td>        <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::command" title='I8257State::command' data-ref="I8257State::command">command</a> = <var>0</var>;</td></tr>
<tr><th id="242">242</th><td>        <b>break</b>;</td></tr>
<tr><th id="243">243</th><td></td></tr>
<tr><th id="244">244</th><td>    <b>case</b> <var>0x06</var>:                  <i>/* clear mask for all channels */</i></td></tr>
<tr><th id="245">245</th><td>        <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::mask" title='I8257State::mask' data-ref="I8257State::mask">mask</a> = <var>0</var>;</td></tr>
<tr><th id="246">246</th><td>        <a class="tu ref" href="#i8257_dma_run" title='i8257_dma_run' data-use='c' data-ref="i8257_dma_run">i8257_dma_run</a>(<a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>);</td></tr>
<tr><th id="247">247</th><td>        <b>break</b>;</td></tr>
<tr><th id="248">248</th><td></td></tr>
<tr><th id="249">249</th><td>    <b>case</b> <var>0x07</var>:                  <i>/* write mask for all channels */</i></td></tr>
<tr><th id="250">250</th><td>        <a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::mask" title='I8257State::mask' data-ref="I8257State::mask">mask</a> = <a class="local col8 ref" href="#138data" title='data' data-ref="138data">data</a>;</td></tr>
<tr><th id="251">251</th><td>        <a class="tu ref" href="#i8257_dma_run" title='i8257_dma_run' data-use='c' data-ref="i8257_dma_run">i8257_dma_run</a>(<a class="local col0 ref" href="#140d" title='d' data-ref="140d">d</a>);</td></tr>
<tr><th id="252">252</th><td>        <b>break</b>;</td></tr>
<tr><th id="253">253</th><td></td></tr>
<tr><th id="254">254</th><td>    <b>default</b>:</td></tr>
<tr><th id="255">255</th><td>        <a class="macro" href="#36" title="fprintf (stderr, &quot;dma: &quot; &quot;unknown iport %#x\n&quot;, iport)" data-ref="_M/dolog">dolog</a> (<q>"unknown iport %#x\n"</q>, <a class="local col1 ref" href="#141iport" title='iport' data-ref="141iport">iport</a>);</td></tr>
<tr><th id="256">256</th><td>        <b>break</b>;</td></tr>
<tr><th id="257">257</th><td>    }</td></tr>
<tr><th id="258">258</th><td></td></tr>
<tr><th id="259">259</th><td><u>#<span data-ppcond="259">ifdef</span> <span class="macro" data-ref="_M/DEBUG_DMA">DEBUG_DMA</span></u></td></tr>
<tr><th id="260">260</th><td>    <b>if</b> (<var>0xc</var> != iport) {</td></tr>
<tr><th id="261">261</th><td>        linfo (<q>"write_cont: nport %#06x, ichan % 2d, val %#06x\n"</q>,</td></tr>
<tr><th id="262">262</th><td>               nport, ichan, data);</td></tr>
<tr><th id="263">263</th><td>    }</td></tr>
<tr><th id="264">264</th><td><u>#<span data-ppcond="259">endif</span></u></td></tr>
<tr><th id="265">265</th><td>}</td></tr>
<tr><th id="266">266</th><td></td></tr>
<tr><th id="267">267</th><td><em>static</em> <a class="typedef" href="../../../include/stdint.h.html#uint64_t" title='uint64_t' data-type='unsigned long' data-ref="uint64_t">uint64_t</a> <dfn class="tu decl def" id="i8257_read_cont" title='i8257_read_cont' data-type='uint64_t i8257_read_cont(void * opaque, hwaddr nport, unsigned int size)' data-ref="i8257_read_cont">i8257_read_cont</dfn>(<em>void</em> *<dfn class="local col3 decl" id="143opaque" title='opaque' data-type='void *' data-ref="143opaque">opaque</dfn>, <a class="typedef" href="../../include/exec/hwaddr.h.html#hwaddr" title='hwaddr' data-type='uint64_t' data-ref="hwaddr">hwaddr</a> <dfn class="local col4 decl" id="144nport" title='nport' data-type='hwaddr' data-ref="144nport">nport</dfn>, <em>unsigned</em> <dfn class="local col5 decl" id="145size" title='size' data-type='unsigned int' data-ref="145size">size</dfn>)</td></tr>
<tr><th id="268">268</th><td>{</td></tr>
<tr><th id="269">269</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col6 decl" id="146d" title='d' data-type='I8257State *' data-ref="146d">d</dfn> = <a class="local col3 ref" href="#143opaque" title='opaque' data-ref="143opaque">opaque</a>;</td></tr>
<tr><th id="270">270</th><td>    <em>int</em> <dfn class="local col7 decl" id="147iport" title='iport' data-type='int' data-ref="147iport">iport</dfn>, <dfn class="local col8 decl" id="148val" title='val' data-type='int' data-ref="148val">val</dfn>;</td></tr>
<tr><th id="271">271</th><td></td></tr>
<tr><th id="272">272</th><td>    <a class="local col7 ref" href="#147iport" title='iport' data-ref="147iport">iport</a> = (<a class="local col4 ref" href="#144nport" title='nport' data-ref="144nport">nport</a> &gt;&gt; <a class="local col6 ref" href="#146d" title='d' data-ref="146d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dshift" title='I8257State::dshift' data-ref="I8257State::dshift">dshift</a>) &amp; <var>0x0f</var>;</td></tr>
<tr><th id="273">273</th><td>    <b>switch</b> (<a class="local col7 ref" href="#147iport" title='iport' data-ref="147iport">iport</a>) {</td></tr>
<tr><th id="274">274</th><td>    <b>case</b> <var>0x00</var>:                  <i>/* status */</i></td></tr>
<tr><th id="275">275</th><td>        <a class="local col8 ref" href="#148val" title='val' data-ref="148val">val</a> = <a class="local col6 ref" href="#146d" title='d' data-ref="146d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::status" title='I8257State::status' data-ref="I8257State::status">status</a>;</td></tr>
<tr><th id="276">276</th><td>        <a class="local col6 ref" href="#146d" title='d' data-ref="146d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::status" title='I8257State::status' data-ref="I8257State::status">status</a> &amp;= <var>0xf0</var>;</td></tr>
<tr><th id="277">277</th><td>        <b>break</b>;</td></tr>
<tr><th id="278">278</th><td>    <b>case</b> <var>0x01</var>:                  <i>/* mask */</i></td></tr>
<tr><th id="279">279</th><td>        <a class="local col8 ref" href="#148val" title='val' data-ref="148val">val</a> = <a class="local col6 ref" href="#146d" title='d' data-ref="146d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::mask" title='I8257State::mask' data-ref="I8257State::mask">mask</a>;</td></tr>
<tr><th id="280">280</th><td>        <b>break</b>;</td></tr>
<tr><th id="281">281</th><td>    <b>default</b>:</td></tr>
<tr><th id="282">282</th><td>        <a class="local col8 ref" href="#148val" title='val' data-ref="148val">val</a> = <var>0</var>;</td></tr>
<tr><th id="283">283</th><td>        <b>break</b>;</td></tr>
<tr><th id="284">284</th><td>    }</td></tr>
<tr><th id="285">285</th><td></td></tr>
<tr><th id="286">286</th><td>    <a class="macro" href="#42" title="" data-ref="_M/ldebug">ldebug</a> (<q>"read_cont: nport %#06x, iport %#04x val %#x\n"</q>, nport, iport, val);</td></tr>
<tr><th id="287">287</th><td>    <b>return</b> <a class="local col8 ref" href="#148val" title='val' data-ref="148val">val</a>;</td></tr>
<tr><th id="288">288</th><td>}</td></tr>
<tr><th id="289">289</th><td></td></tr>
<tr><th id="290">290</th><td><em>static</em> <a class="typedef" href="../../include/hw/isa/isa.h.html#IsaDmaTransferMode" title='IsaDmaTransferMode' data-type='enum IsaDmaTransferMode' data-ref="IsaDmaTransferMode">IsaDmaTransferMode</a> <dfn class="tu decl def" id="i8257_dma_get_transfer_mode" title='i8257_dma_get_transfer_mode' data-type='IsaDmaTransferMode i8257_dma_get_transfer_mode(IsaDma * obj, int nchan)' data-ref="i8257_dma_get_transfer_mode">i8257_dma_get_transfer_mode</dfn>(<a class="typedef" href="../../include/qemu/typedefs.h.html#IsaDma" title='IsaDma' data-type='struct IsaDma' data-ref="IsaDma">IsaDma</a> *<dfn class="local col9 decl" id="149obj" title='obj' data-type='IsaDma *' data-ref="149obj">obj</dfn>, <em>int</em> <dfn class="local col0 decl" id="150nchan" title='nchan' data-type='int' data-ref="150nchan">nchan</dfn>)</td></tr>
<tr><th id="291">291</th><td>{</td></tr>
<tr><th id="292">292</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col1 decl" id="151d" title='d' data-type='I8257State *' data-ref="151d">d</dfn> = <a class="macro" href="#31" title="((I8257State *)object_dynamic_cast_assert(((Object *)((obj))), (&quot;i8257&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 292, __func__))" data-ref="_M/I8257">I8257</a>(<a class="local col9 ref" href="#149obj" title='obj' data-ref="149obj">obj</a>);</td></tr>
<tr><th id="293">293</th><td>    <b>return</b> (<a class="local col1 ref" href="#151d" title='d' data-ref="151d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a>[<a class="local col0 ref" href="#150nchan" title='nchan' data-ref="150nchan">nchan</a> &amp; <var>3</var>].<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::mode" title='I8257Regs::mode' data-ref="I8257Regs::mode">mode</a> &gt;&gt; <var>2</var>) &amp; <var>3</var>;</td></tr>
<tr><th id="294">294</th><td>}</td></tr>
<tr><th id="295">295</th><td></td></tr>
<tr><th id="296">296</th><td><em>static</em> <span class="macro" title="_Bool" data-ref="_M/bool">bool</span> <dfn class="tu decl def" id="i8257_dma_has_autoinitialization" title='i8257_dma_has_autoinitialization' data-type='_Bool i8257_dma_has_autoinitialization(IsaDma * obj, int nchan)' data-ref="i8257_dma_has_autoinitialization">i8257_dma_has_autoinitialization</dfn>(<a class="typedef" href="../../include/qemu/typedefs.h.html#IsaDma" title='IsaDma' data-type='struct IsaDma' data-ref="IsaDma">IsaDma</a> *<dfn class="local col2 decl" id="152obj" title='obj' data-type='IsaDma *' data-ref="152obj">obj</dfn>, <em>int</em> <dfn class="local col3 decl" id="153nchan" title='nchan' data-type='int' data-ref="153nchan">nchan</dfn>)</td></tr>
<tr><th id="297">297</th><td>{</td></tr>
<tr><th id="298">298</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col4 decl" id="154d" title='d' data-type='I8257State *' data-ref="154d">d</dfn> = <a class="macro" href="#31" title="((I8257State *)object_dynamic_cast_assert(((Object *)((obj))), (&quot;i8257&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 298, __func__))" data-ref="_M/I8257">I8257</a>(<a class="local col2 ref" href="#152obj" title='obj' data-ref="152obj">obj</a>);</td></tr>
<tr><th id="299">299</th><td>    <b>return</b> (<a class="local col4 ref" href="#154d" title='d' data-ref="154d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a>[<a class="local col3 ref" href="#153nchan" title='nchan' data-ref="153nchan">nchan</a> &amp; <var>3</var>].<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::mode" title='I8257Regs::mode' data-ref="I8257Regs::mode">mode</a> &gt;&gt; <var>4</var>) &amp; <var>1</var>;</td></tr>
<tr><th id="300">300</th><td>}</td></tr>
<tr><th id="301">301</th><td></td></tr>
<tr><th id="302">302</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="i8257_dma_hold_DREQ" title='i8257_dma_hold_DREQ' data-type='void i8257_dma_hold_DREQ(IsaDma * obj, int nchan)' data-ref="i8257_dma_hold_DREQ">i8257_dma_hold_DREQ</dfn>(<a class="typedef" href="../../include/qemu/typedefs.h.html#IsaDma" title='IsaDma' data-type='struct IsaDma' data-ref="IsaDma">IsaDma</a> *<dfn class="local col5 decl" id="155obj" title='obj' data-type='IsaDma *' data-ref="155obj">obj</dfn>, <em>int</em> <dfn class="local col6 decl" id="156nchan" title='nchan' data-type='int' data-ref="156nchan">nchan</dfn>)</td></tr>
<tr><th id="303">303</th><td>{</td></tr>
<tr><th id="304">304</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col7 decl" id="157d" title='d' data-type='I8257State *' data-ref="157d">d</dfn> = <a class="macro" href="#31" title="((I8257State *)object_dynamic_cast_assert(((Object *)((obj))), (&quot;i8257&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 304, __func__))" data-ref="_M/I8257">I8257</a>(<a class="local col5 ref" href="#155obj" title='obj' data-ref="155obj">obj</a>);</td></tr>
<tr><th id="305">305</th><td>    <em>int</em> <dfn class="local col8 decl" id="158ichan" title='ichan' data-type='int' data-ref="158ichan">ichan</dfn>;</td></tr>
<tr><th id="306">306</th><td></td></tr>
<tr><th id="307">307</th><td>    <a class="local col8 ref" href="#158ichan" title='ichan' data-ref="158ichan">ichan</a> = <a class="local col6 ref" href="#156nchan" title='nchan' data-ref="156nchan">nchan</a> &amp; <var>3</var>;</td></tr>
<tr><th id="308">308</th><td>    <a class="local col7 ref" href="#157d" title='d' data-ref="157d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::status" title='I8257State::status' data-ref="I8257State::status">status</a> |= <var>1</var> &lt;&lt; (<a class="local col8 ref" href="#158ichan" title='ichan' data-ref="158ichan">ichan</a> + <var>4</var>);</td></tr>
<tr><th id="309">309</th><td>    <a class="tu ref" href="#i8257_dma_run" title='i8257_dma_run' data-use='c' data-ref="i8257_dma_run">i8257_dma_run</a>(<a class="local col7 ref" href="#157d" title='d' data-ref="157d">d</a>);</td></tr>
<tr><th id="310">310</th><td>}</td></tr>
<tr><th id="311">311</th><td></td></tr>
<tr><th id="312">312</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="i8257_dma_release_DREQ" title='i8257_dma_release_DREQ' data-type='void i8257_dma_release_DREQ(IsaDma * obj, int nchan)' data-ref="i8257_dma_release_DREQ">i8257_dma_release_DREQ</dfn>(<a class="typedef" href="../../include/qemu/typedefs.h.html#IsaDma" title='IsaDma' data-type='struct IsaDma' data-ref="IsaDma">IsaDma</a> *<dfn class="local col9 decl" id="159obj" title='obj' data-type='IsaDma *' data-ref="159obj">obj</dfn>, <em>int</em> <dfn class="local col0 decl" id="160nchan" title='nchan' data-type='int' data-ref="160nchan">nchan</dfn>)</td></tr>
<tr><th id="313">313</th><td>{</td></tr>
<tr><th id="314">314</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col1 decl" id="161d" title='d' data-type='I8257State *' data-ref="161d">d</dfn> = <a class="macro" href="#31" title="((I8257State *)object_dynamic_cast_assert(((Object *)((obj))), (&quot;i8257&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 314, __func__))" data-ref="_M/I8257">I8257</a>(<a class="local col9 ref" href="#159obj" title='obj' data-ref="159obj">obj</a>);</td></tr>
<tr><th id="315">315</th><td>    <em>int</em> <dfn class="local col2 decl" id="162ichan" title='ichan' data-type='int' data-ref="162ichan">ichan</dfn>;</td></tr>
<tr><th id="316">316</th><td></td></tr>
<tr><th id="317">317</th><td>    <a class="local col2 ref" href="#162ichan" title='ichan' data-ref="162ichan">ichan</a> = <a class="local col0 ref" href="#160nchan" title='nchan' data-ref="160nchan">nchan</a> &amp; <var>3</var>;</td></tr>
<tr><th id="318">318</th><td>    <a class="local col1 ref" href="#161d" title='d' data-ref="161d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::status" title='I8257State::status' data-ref="I8257State::status">status</a> &amp;= ~(<var>1</var> &lt;&lt; (<a class="local col2 ref" href="#162ichan" title='ichan' data-ref="162ichan">ichan</a> + <var>4</var>));</td></tr>
<tr><th id="319">319</th><td>    <a class="tu ref" href="#i8257_dma_run" title='i8257_dma_run' data-use='c' data-ref="i8257_dma_run">i8257_dma_run</a>(<a class="local col1 ref" href="#161d" title='d' data-ref="161d">d</a>);</td></tr>
<tr><th id="320">320</th><td>}</td></tr>
<tr><th id="321">321</th><td></td></tr>
<tr><th id="322">322</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="i8257_channel_run" title='i8257_channel_run' data-type='void i8257_channel_run(I8257State * d, int ichan)' data-ref="i8257_channel_run">i8257_channel_run</dfn>(<a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col3 decl" id="163d" title='d' data-type='I8257State *' data-ref="163d">d</dfn>, <em>int</em> <dfn class="local col4 decl" id="164ichan" title='ichan' data-type='int' data-ref="164ichan">ichan</dfn>)</td></tr>
<tr><th id="323">323</th><td>{</td></tr>
<tr><th id="324">324</th><td>    <em>int</em> <dfn class="local col5 decl" id="165ncont" title='ncont' data-type='int' data-ref="165ncont">ncont</dfn> = <a class="local col3 ref" href="#163d" title='d' data-ref="163d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dshift" title='I8257State::dshift' data-ref="I8257State::dshift">dshift</a>;</td></tr>
<tr><th id="325">325</th><td>    <em>int</em> <dfn class="local col6 decl" id="166n" title='n' data-type='int' data-ref="166n">n</dfn>;</td></tr>
<tr><th id="326">326</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a> *<dfn class="local col7 decl" id="167r" title='r' data-type='I8257Regs *' data-ref="167r">r</dfn> = &amp;<a class="local col3 ref" href="#163d" title='d' data-ref="163d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a>[<a class="local col4 ref" href="#164ichan" title='ichan' data-ref="164ichan">ichan</a>];</td></tr>
<tr><th id="327">327</th><td><u>#<span data-ppcond="327">ifdef</span> <span class="macro" data-ref="_M/DEBUG_DMA">DEBUG_DMA</span></u></td></tr>
<tr><th id="328">328</th><td>    <em>int</em> dir, opmode;</td></tr>
<tr><th id="329">329</th><td></td></tr>
<tr><th id="330">330</th><td>    dir = (r-&gt;mode &gt;&gt; <var>5</var>) &amp; <var>1</var>;</td></tr>
<tr><th id="331">331</th><td>    opmode = (r-&gt;mode &gt;&gt; <var>6</var>) &amp; <var>3</var>;</td></tr>
<tr><th id="332">332</th><td></td></tr>
<tr><th id="333">333</th><td>    <b>if</b> (dir) {</td></tr>
<tr><th id="334">334</th><td>        dolog (<q>"DMA in address decrement mode\n"</q>);</td></tr>
<tr><th id="335">335</th><td>    }</td></tr>
<tr><th id="336">336</th><td>    <b>if</b> (opmode != <var>1</var>) {</td></tr>
<tr><th id="337">337</th><td>        dolog (<q>"DMA not in single mode select %#x\n"</q>, opmode);</td></tr>
<tr><th id="338">338</th><td>    }</td></tr>
<tr><th id="339">339</th><td><u>#<span data-ppcond="327">endif</span></u></td></tr>
<tr><th id="340">340</th><td></td></tr>
<tr><th id="341">341</th><td>    <a class="local col6 ref" href="#166n" title='n' data-ref="166n">n</a> = <a class="local col7 ref" href="#167r" title='r' data-ref="167r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::transfer_handler" title='I8257Regs::transfer_handler' data-ref="I8257Regs::transfer_handler">transfer_handler</a> (<a class="local col7 ref" href="#167r" title='r' data-ref="167r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::opaque" title='I8257Regs::opaque' data-ref="I8257Regs::opaque">opaque</a>, <a class="local col4 ref" href="#164ichan" title='ichan' data-ref="164ichan">ichan</a> + (<a class="local col5 ref" href="#165ncont" title='ncont' data-ref="165ncont">ncont</a> &lt;&lt; <var>2</var>),</td></tr>
<tr><th id="342">342</th><td>                             <a class="local col7 ref" href="#167r" title='r' data-ref="167r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::now" title='I8257Regs::now' data-ref="I8257Regs::now">now</a>[<a class="macro" href="#46" title="1" data-ref="_M/COUNT">COUNT</a>], (<a class="local col7 ref" href="#167r" title='r' data-ref="167r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::base" title='I8257Regs::base' data-ref="I8257Regs::base">base</a>[<a class="macro" href="#46" title="1" data-ref="_M/COUNT">COUNT</a>] + <var>1</var>) &lt;&lt; <a class="local col5 ref" href="#165ncont" title='ncont' data-ref="165ncont">ncont</a>);</td></tr>
<tr><th id="343">343</th><td>    <a class="local col7 ref" href="#167r" title='r' data-ref="167r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::now" title='I8257Regs::now' data-ref="I8257Regs::now">now</a>[<a class="macro" href="#46" title="1" data-ref="_M/COUNT">COUNT</a>] = <a class="local col6 ref" href="#166n" title='n' data-ref="166n">n</a>;</td></tr>
<tr><th id="344">344</th><td>    <a class="macro" href="#42" title="" data-ref="_M/ldebug">ldebug</a> (<q>"dma_pos %d size %d\n"</q>, n, (r-&gt;base[COUNT] + <var>1</var>) &lt;&lt; ncont);</td></tr>
<tr><th id="345">345</th><td>    <b>if</b> (<a class="local col6 ref" href="#166n" title='n' data-ref="166n">n</a> == (<a class="local col7 ref" href="#167r" title='r' data-ref="167r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::base" title='I8257Regs::base' data-ref="I8257Regs::base">base</a>[<a class="macro" href="#46" title="1" data-ref="_M/COUNT">COUNT</a>] + <var>1</var>) &lt;&lt; <a class="local col5 ref" href="#165ncont" title='ncont' data-ref="165ncont">ncont</a>) {</td></tr>
<tr><th id="346">346</th><td>        <a class="macro" href="#42" title="" data-ref="_M/ldebug">ldebug</a>(<q>"transfer done\n"</q>);</td></tr>
<tr><th id="347">347</th><td>        <a class="local col3 ref" href="#163d" title='d' data-ref="163d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::status" title='I8257State::status' data-ref="I8257State::status">status</a> |= (<var>1</var> &lt;&lt; <a class="local col4 ref" href="#164ichan" title='ichan' data-ref="164ichan">ichan</a>);</td></tr>
<tr><th id="348">348</th><td>    }</td></tr>
<tr><th id="349">349</th><td>}</td></tr>
<tr><th id="350">350</th><td></td></tr>
<tr><th id="351">351</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="i8257_dma_run" title='i8257_dma_run' data-type='void i8257_dma_run(void * opaque)' data-ref="i8257_dma_run">i8257_dma_run</dfn>(<em>void</em> *<dfn class="local col8 decl" id="168opaque" title='opaque' data-type='void *' data-ref="168opaque">opaque</dfn>)</td></tr>
<tr><th id="352">352</th><td>{</td></tr>
<tr><th id="353">353</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col9 decl" id="169d" title='d' data-type='I8257State *' data-ref="169d">d</dfn> = <a class="local col8 ref" href="#168opaque" title='opaque' data-ref="168opaque">opaque</a>;</td></tr>
<tr><th id="354">354</th><td>    <em>int</em> <dfn class="local col0 decl" id="170ichan" title='ichan' data-type='int' data-ref="170ichan">ichan</dfn>;</td></tr>
<tr><th id="355">355</th><td>    <em>int</em> <dfn class="local col1 decl" id="171rearm" title='rearm' data-type='int' data-ref="171rearm">rearm</dfn> = <var>0</var>;</td></tr>
<tr><th id="356">356</th><td></td></tr>
<tr><th id="357">357</th><td>    <b>if</b> (<a class="local col9 ref" href="#169d" title='d' data-ref="169d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::running" title='I8257State::running' data-ref="I8257State::running">running</a>) {</td></tr>
<tr><th id="358">358</th><td>        <a class="local col1 ref" href="#171rearm" title='rearm' data-ref="171rearm">rearm</a> = <var>1</var>;</td></tr>
<tr><th id="359">359</th><td>        <b>goto</b> <a class="lbl" href="#172out" data-ref="172out">out</a>;</td></tr>
<tr><th id="360">360</th><td>    } <b>else</b> {</td></tr>
<tr><th id="361">361</th><td>        <a class="local col9 ref" href="#169d" title='d' data-ref="169d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::running" title='I8257State::running' data-ref="I8257State::running">running</a> = <var>1</var>;</td></tr>
<tr><th id="362">362</th><td>    }</td></tr>
<tr><th id="363">363</th><td></td></tr>
<tr><th id="364">364</th><td>    <b>for</b> (<a class="local col0 ref" href="#170ichan" title='ichan' data-ref="170ichan">ichan</a> = <var>0</var>; <a class="local col0 ref" href="#170ichan" title='ichan' data-ref="170ichan">ichan</a> &lt; <var>4</var>; <a class="local col0 ref" href="#170ichan" title='ichan' data-ref="170ichan">ichan</a>++) {</td></tr>
<tr><th id="365">365</th><td>        <em>int</em> <dfn class="local col3 decl" id="173mask" title='mask' data-type='int' data-ref="173mask">mask</dfn>;</td></tr>
<tr><th id="366">366</th><td></td></tr>
<tr><th id="367">367</th><td>        <a class="local col3 ref" href="#173mask" title='mask' data-ref="173mask">mask</a> = <var>1</var> &lt;&lt; <a class="local col0 ref" href="#170ichan" title='ichan' data-ref="170ichan">ichan</a>;</td></tr>
<tr><th id="368">368</th><td></td></tr>
<tr><th id="369">369</th><td>        <b>if</b> ((<var>0</var> == (<a class="local col9 ref" href="#169d" title='d' data-ref="169d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::mask" title='I8257State::mask' data-ref="I8257State::mask">mask</a> &amp; <a class="local col3 ref" href="#173mask" title='mask' data-ref="173mask">mask</a>)) &amp;&amp; (<var>0</var> != (<a class="local col9 ref" href="#169d" title='d' data-ref="169d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::status" title='I8257State::status' data-ref="I8257State::status">status</a> &amp; (<a class="local col3 ref" href="#173mask" title='mask' data-ref="173mask">mask</a> &lt;&lt; <var>4</var>)))) {</td></tr>
<tr><th id="370">370</th><td>            <a class="tu ref" href="#i8257_channel_run" title='i8257_channel_run' data-use='c' data-ref="i8257_channel_run">i8257_channel_run</a>(<a class="local col9 ref" href="#169d" title='d' data-ref="169d">d</a>, <a class="local col0 ref" href="#170ichan" title='ichan' data-ref="170ichan">ichan</a>);</td></tr>
<tr><th id="371">371</th><td>            <a class="local col1 ref" href="#171rearm" title='rearm' data-ref="171rearm">rearm</a> = <var>1</var>;</td></tr>
<tr><th id="372">372</th><td>        }</td></tr>
<tr><th id="373">373</th><td>    }</td></tr>
<tr><th id="374">374</th><td></td></tr>
<tr><th id="375">375</th><td>    <a class="local col9 ref" href="#169d" title='d' data-ref="169d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::running" title='I8257State::running' data-ref="I8257State::running">running</a> = <var>0</var>;</td></tr>
<tr><th id="376">376</th><td><dfn class="lbl" id="172out" data-ref="172out">out</dfn>:</td></tr>
<tr><th id="377">377</th><td>    <b>if</b> (<a class="local col1 ref" href="#171rearm" title='rearm' data-ref="171rearm">rearm</a>) {</td></tr>
<tr><th id="378">378</th><td>        <a class="ref" href="../../include/qemu/main-loop.h.html#qemu_bh_schedule_idle" title='qemu_bh_schedule_idle' data-ref="qemu_bh_schedule_idle">qemu_bh_schedule_idle</a>(<a class="local col9 ref" href="#169d" title='d' data-ref="169d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dma_bh" title='I8257State::dma_bh' data-ref="I8257State::dma_bh">dma_bh</a>);</td></tr>
<tr><th id="379">379</th><td>        <a class="local col9 ref" href="#169d" title='d' data-ref="169d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dma_bh_scheduled" title='I8257State::dma_bh_scheduled' data-ref="I8257State::dma_bh_scheduled">dma_bh_scheduled</a> = <span class="macro" title="1" data-ref="_M/true">true</span>;</td></tr>
<tr><th id="380">380</th><td>    }</td></tr>
<tr><th id="381">381</th><td>}</td></tr>
<tr><th id="382">382</th><td></td></tr>
<tr><th id="383">383</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="i8257_dma_register_channel" title='i8257_dma_register_channel' data-type='void i8257_dma_register_channel(IsaDma * obj, int nchan, IsaDmaTransferHandler transfer_handler, void * opaque)' data-ref="i8257_dma_register_channel">i8257_dma_register_channel</dfn>(<a class="typedef" href="../../include/qemu/typedefs.h.html#IsaDma" title='IsaDma' data-type='struct IsaDma' data-ref="IsaDma">IsaDma</a> *<dfn class="local col4 decl" id="174obj" title='obj' data-type='IsaDma *' data-ref="174obj">obj</dfn>, <em>int</em> <dfn class="local col5 decl" id="175nchan" title='nchan' data-type='int' data-ref="175nchan">nchan</dfn>,</td></tr>
<tr><th id="384">384</th><td>                                       <a class="typedef" href="../../include/hw/isa/isa.h.html#IsaDmaTransferHandler" title='IsaDmaTransferHandler' data-type='int (*)(void *, int, int, int)' data-ref="IsaDmaTransferHandler">IsaDmaTransferHandler</a> <dfn class="local col6 decl" id="176transfer_handler" title='transfer_handler' data-type='IsaDmaTransferHandler' data-ref="176transfer_handler">transfer_handler</dfn>,</td></tr>
<tr><th id="385">385</th><td>                                       <em>void</em> *<dfn class="local col7 decl" id="177opaque" title='opaque' data-type='void *' data-ref="177opaque">opaque</dfn>)</td></tr>
<tr><th id="386">386</th><td>{</td></tr>
<tr><th id="387">387</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col8 decl" id="178d" title='d' data-type='I8257State *' data-ref="178d">d</dfn> = <a class="macro" href="#31" title="((I8257State *)object_dynamic_cast_assert(((Object *)((obj))), (&quot;i8257&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 387, __func__))" data-ref="_M/I8257">I8257</a>(<a class="local col4 ref" href="#174obj" title='obj' data-ref="174obj">obj</a>);</td></tr>
<tr><th id="388">388</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a> *<dfn class="local col9 decl" id="179r" title='r' data-type='I8257Regs *' data-ref="179r">r</dfn>;</td></tr>
<tr><th id="389">389</th><td>    <em>int</em> <dfn class="local col0 decl" id="180ichan" title='ichan' data-type='int' data-ref="180ichan">ichan</dfn>;</td></tr>
<tr><th id="390">390</th><td></td></tr>
<tr><th id="391">391</th><td>    <a class="local col0 ref" href="#180ichan" title='ichan' data-ref="180ichan">ichan</a> = <a class="local col5 ref" href="#175nchan" title='nchan' data-ref="175nchan">nchan</a> &amp; <var>3</var>;</td></tr>
<tr><th id="392">392</th><td></td></tr>
<tr><th id="393">393</th><td>    <a class="local col9 ref" href="#179r" title='r' data-ref="179r">r</a> = <a class="local col8 ref" href="#178d" title='d' data-ref="178d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a> + <a class="local col0 ref" href="#180ichan" title='ichan' data-ref="180ichan">ichan</a>;</td></tr>
<tr><th id="394">394</th><td>    <a class="local col9 ref" href="#179r" title='r' data-ref="179r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::transfer_handler" title='I8257Regs::transfer_handler' data-ref="I8257Regs::transfer_handler">transfer_handler</a> = <a class="local col6 ref" href="#176transfer_handler" title='transfer_handler' data-ref="176transfer_handler">transfer_handler</a>;</td></tr>
<tr><th id="395">395</th><td>    <a class="local col9 ref" href="#179r" title='r' data-ref="179r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::opaque" title='I8257Regs::opaque' data-ref="I8257Regs::opaque">opaque</a> = <a class="local col7 ref" href="#177opaque" title='opaque' data-ref="177opaque">opaque</a>;</td></tr>
<tr><th id="396">396</th><td>}</td></tr>
<tr><th id="397">397</th><td></td></tr>
<tr><th id="398">398</th><td><em>static</em> <em>int</em> <dfn class="tu decl def" id="i8257_dma_read_memory" title='i8257_dma_read_memory' data-type='int i8257_dma_read_memory(IsaDma * obj, int nchan, void * buf, int pos, int len)' data-ref="i8257_dma_read_memory">i8257_dma_read_memory</dfn>(<a class="typedef" href="../../include/qemu/typedefs.h.html#IsaDma" title='IsaDma' data-type='struct IsaDma' data-ref="IsaDma">IsaDma</a> *<dfn class="local col1 decl" id="181obj" title='obj' data-type='IsaDma *' data-ref="181obj">obj</dfn>, <em>int</em> <dfn class="local col2 decl" id="182nchan" title='nchan' data-type='int' data-ref="182nchan">nchan</dfn>, <em>void</em> *<dfn class="local col3 decl" id="183buf" title='buf' data-type='void *' data-ref="183buf">buf</dfn>, <em>int</em> <dfn class="local col4 decl" id="184pos" title='pos' data-type='int' data-ref="184pos">pos</dfn>,</td></tr>
<tr><th id="399">399</th><td>                                 <em>int</em> <dfn class="local col5 decl" id="185len" title='len' data-type='int' data-ref="185len">len</dfn>)</td></tr>
<tr><th id="400">400</th><td>{</td></tr>
<tr><th id="401">401</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col6 decl" id="186d" title='d' data-type='I8257State *' data-ref="186d">d</dfn> = <a class="macro" href="#31" title="((I8257State *)object_dynamic_cast_assert(((Object *)((obj))), (&quot;i8257&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 401, __func__))" data-ref="_M/I8257">I8257</a>(<a class="local col1 ref" href="#181obj" title='obj' data-ref="181obj">obj</a>);</td></tr>
<tr><th id="402">402</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a> *<dfn class="local col7 decl" id="187r" title='r' data-type='I8257Regs *' data-ref="187r">r</dfn> = &amp;<a class="local col6 ref" href="#186d" title='d' data-ref="186d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a>[<a class="local col2 ref" href="#182nchan" title='nchan' data-ref="182nchan">nchan</a> &amp; <var>3</var>];</td></tr>
<tr><th id="403">403</th><td>    <a class="typedef" href="../../include/exec/hwaddr.h.html#hwaddr" title='hwaddr' data-type='uint64_t' data-ref="hwaddr">hwaddr</a> <dfn class="local col8 decl" id="188addr" title='addr' data-type='hwaddr' data-ref="188addr">addr</dfn> = ((<a class="local col7 ref" href="#187r" title='r' data-ref="187r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::pageh" title='I8257Regs::pageh' data-ref="I8257Regs::pageh">pageh</a> &amp; <var>0x7f</var>) &lt;&lt; <var>24</var>) | (<a class="local col7 ref" href="#187r" title='r' data-ref="187r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::page" title='I8257Regs::page' data-ref="I8257Regs::page">page</a> &lt;&lt; <var>16</var>) | <a class="local col7 ref" href="#187r" title='r' data-ref="187r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::now" title='I8257Regs::now' data-ref="I8257Regs::now">now</a>[<a class="macro" href="#45" title="0" data-ref="_M/ADDR">ADDR</a>];</td></tr>
<tr><th id="404">404</th><td></td></tr>
<tr><th id="405">405</th><td>    <b>if</b> (<a class="local col7 ref" href="#187r" title='r' data-ref="187r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::mode" title='I8257Regs::mode' data-ref="I8257Regs::mode">mode</a> &amp; <var>0x20</var>) {</td></tr>
<tr><th id="406">406</th><td>        <em>int</em> <dfn class="local col9 decl" id="189i" title='i' data-type='int' data-ref="189i">i</dfn>;</td></tr>
<tr><th id="407">407</th><td>        <a class="typedef" href="../../../include/stdint.h.html#uint8_t" title='uint8_t' data-type='unsigned char' data-ref="uint8_t">uint8_t</a> *<dfn class="local col0 decl" id="190p" title='p' data-type='uint8_t *' data-ref="190p">p</dfn> = <a class="local col3 ref" href="#183buf" title='buf' data-ref="183buf">buf</a>;</td></tr>
<tr><th id="408">408</th><td></td></tr>
<tr><th id="409">409</th><td>        <a class="ref" href="../../include/exec/cpu-common.h.html#cpu_physical_memory_read" title='cpu_physical_memory_read' data-ref="cpu_physical_memory_read">cpu_physical_memory_read</a> (<a class="local col8 ref" href="#188addr" title='addr' data-ref="188addr">addr</a> - <a class="local col4 ref" href="#184pos" title='pos' data-ref="184pos">pos</a> - <a class="local col5 ref" href="#185len" title='len' data-ref="185len">len</a>, <a class="local col3 ref" href="#183buf" title='buf' data-ref="183buf">buf</a>, <a class="local col5 ref" href="#185len" title='len' data-ref="185len">len</a>);</td></tr>
<tr><th id="410">410</th><td>        <i>/* What about 16bit transfers? */</i></td></tr>
<tr><th id="411">411</th><td>        <b>for</b> (<a class="local col9 ref" href="#189i" title='i' data-ref="189i">i</a> = <var>0</var>; <a class="local col9 ref" href="#189i" title='i' data-ref="189i">i</a> &lt; <a class="local col5 ref" href="#185len" title='len' data-ref="185len">len</a> &gt;&gt; <var>1</var>; <a class="local col9 ref" href="#189i" title='i' data-ref="189i">i</a>++) {</td></tr>
<tr><th id="412">412</th><td>            <a class="typedef" href="../../../include/stdint.h.html#uint8_t" title='uint8_t' data-type='unsigned char' data-ref="uint8_t">uint8_t</a> <dfn class="local col1 decl" id="191b" title='b' data-type='uint8_t' data-ref="191b">b</dfn> = <a class="local col0 ref" href="#190p" title='p' data-ref="190p">p</a>[<a class="local col5 ref" href="#185len" title='len' data-ref="185len">len</a> - <a class="local col9 ref" href="#189i" title='i' data-ref="189i">i</a> - <var>1</var>];</td></tr>
<tr><th id="413">413</th><td>            <a class="local col0 ref" href="#190p" title='p' data-ref="190p">p</a>[<a class="local col9 ref" href="#189i" title='i' data-ref="189i">i</a>] = <a class="local col1 ref" href="#191b" title='b' data-ref="191b">b</a>;</td></tr>
<tr><th id="414">414</th><td>        }</td></tr>
<tr><th id="415">415</th><td>    }</td></tr>
<tr><th id="416">416</th><td>    <b>else</b></td></tr>
<tr><th id="417">417</th><td>        <a class="ref" href="../../include/exec/cpu-common.h.html#cpu_physical_memory_read" title='cpu_physical_memory_read' data-ref="cpu_physical_memory_read">cpu_physical_memory_read</a> (<a class="local col8 ref" href="#188addr" title='addr' data-ref="188addr">addr</a> + <a class="local col4 ref" href="#184pos" title='pos' data-ref="184pos">pos</a>, <a class="local col3 ref" href="#183buf" title='buf' data-ref="183buf">buf</a>, <a class="local col5 ref" href="#185len" title='len' data-ref="185len">len</a>);</td></tr>
<tr><th id="418">418</th><td></td></tr>
<tr><th id="419">419</th><td>    <b>return</b> <a class="local col5 ref" href="#185len" title='len' data-ref="185len">len</a>;</td></tr>
<tr><th id="420">420</th><td>}</td></tr>
<tr><th id="421">421</th><td></td></tr>
<tr><th id="422">422</th><td><em>static</em> <em>int</em> <dfn class="tu decl def" id="i8257_dma_write_memory" title='i8257_dma_write_memory' data-type='int i8257_dma_write_memory(IsaDma * obj, int nchan, void * buf, int pos, int len)' data-ref="i8257_dma_write_memory">i8257_dma_write_memory</dfn>(<a class="typedef" href="../../include/qemu/typedefs.h.html#IsaDma" title='IsaDma' data-type='struct IsaDma' data-ref="IsaDma">IsaDma</a> *<dfn class="local col2 decl" id="192obj" title='obj' data-type='IsaDma *' data-ref="192obj">obj</dfn>, <em>int</em> <dfn class="local col3 decl" id="193nchan" title='nchan' data-type='int' data-ref="193nchan">nchan</dfn>, <em>void</em> *<dfn class="local col4 decl" id="194buf" title='buf' data-type='void *' data-ref="194buf">buf</dfn>, <em>int</em> <dfn class="local col5 decl" id="195pos" title='pos' data-type='int' data-ref="195pos">pos</dfn>,</td></tr>
<tr><th id="423">423</th><td>                                 <em>int</em> <dfn class="local col6 decl" id="196len" title='len' data-type='int' data-ref="196len">len</dfn>)</td></tr>
<tr><th id="424">424</th><td>{</td></tr>
<tr><th id="425">425</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col7 decl" id="197s" title='s' data-type='I8257State *' data-ref="197s">s</dfn> = <a class="macro" href="#31" title="((I8257State *)object_dynamic_cast_assert(((Object *)((obj))), (&quot;i8257&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 425, __func__))" data-ref="_M/I8257">I8257</a>(<a class="local col2 ref" href="#192obj" title='obj' data-ref="192obj">obj</a>);</td></tr>
<tr><th id="426">426</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a> *<dfn class="local col8 decl" id="198r" title='r' data-type='I8257Regs *' data-ref="198r">r</dfn> = &amp;<a class="local col7 ref" href="#197s" title='s' data-ref="197s">s</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a>[<a class="local col3 ref" href="#193nchan" title='nchan' data-ref="193nchan">nchan</a> &amp; <var>3</var>];</td></tr>
<tr><th id="427">427</th><td>    <a class="typedef" href="../../include/exec/hwaddr.h.html#hwaddr" title='hwaddr' data-type='uint64_t' data-ref="hwaddr">hwaddr</a> <dfn class="local col9 decl" id="199addr" title='addr' data-type='hwaddr' data-ref="199addr">addr</dfn> = ((<a class="local col8 ref" href="#198r" title='r' data-ref="198r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::pageh" title='I8257Regs::pageh' data-ref="I8257Regs::pageh">pageh</a> &amp; <var>0x7f</var>) &lt;&lt; <var>24</var>) | (<a class="local col8 ref" href="#198r" title='r' data-ref="198r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::page" title='I8257Regs::page' data-ref="I8257Regs::page">page</a> &lt;&lt; <var>16</var>) | <a class="local col8 ref" href="#198r" title='r' data-ref="198r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::now" title='I8257Regs::now' data-ref="I8257Regs::now">now</a>[<a class="macro" href="#45" title="0" data-ref="_M/ADDR">ADDR</a>];</td></tr>
<tr><th id="428">428</th><td></td></tr>
<tr><th id="429">429</th><td>    <b>if</b> (<a class="local col8 ref" href="#198r" title='r' data-ref="198r">r</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::mode" title='I8257Regs::mode' data-ref="I8257Regs::mode">mode</a> &amp; <var>0x20</var>) {</td></tr>
<tr><th id="430">430</th><td>        <em>int</em> <dfn class="local col0 decl" id="200i" title='i' data-type='int' data-ref="200i">i</dfn>;</td></tr>
<tr><th id="431">431</th><td>        <a class="typedef" href="../../../include/stdint.h.html#uint8_t" title='uint8_t' data-type='unsigned char' data-ref="uint8_t">uint8_t</a> *<dfn class="local col1 decl" id="201p" title='p' data-type='uint8_t *' data-ref="201p">p</dfn> = <a class="local col4 ref" href="#194buf" title='buf' data-ref="194buf">buf</a>;</td></tr>
<tr><th id="432">432</th><td></td></tr>
<tr><th id="433">433</th><td>        <a class="ref" href="../../include/exec/cpu-common.h.html#cpu_physical_memory_write" title='cpu_physical_memory_write' data-ref="cpu_physical_memory_write">cpu_physical_memory_write</a> (<a class="local col9 ref" href="#199addr" title='addr' data-ref="199addr">addr</a> - <a class="local col5 ref" href="#195pos" title='pos' data-ref="195pos">pos</a> - <a class="local col6 ref" href="#196len" title='len' data-ref="196len">len</a>, <a class="local col4 ref" href="#194buf" title='buf' data-ref="194buf">buf</a>, <a class="local col6 ref" href="#196len" title='len' data-ref="196len">len</a>);</td></tr>
<tr><th id="434">434</th><td>        <i>/* What about 16bit transfers? */</i></td></tr>
<tr><th id="435">435</th><td>        <b>for</b> (<a class="local col0 ref" href="#200i" title='i' data-ref="200i">i</a> = <var>0</var>; <a class="local col0 ref" href="#200i" title='i' data-ref="200i">i</a> &lt; <a class="local col6 ref" href="#196len" title='len' data-ref="196len">len</a>; <a class="local col0 ref" href="#200i" title='i' data-ref="200i">i</a>++) {</td></tr>
<tr><th id="436">436</th><td>            <a class="typedef" href="../../../include/stdint.h.html#uint8_t" title='uint8_t' data-type='unsigned char' data-ref="uint8_t">uint8_t</a> <dfn class="local col2 decl" id="202b" title='b' data-type='uint8_t' data-ref="202b">b</dfn> = <a class="local col1 ref" href="#201p" title='p' data-ref="201p">p</a>[<a class="local col6 ref" href="#196len" title='len' data-ref="196len">len</a> - <a class="local col0 ref" href="#200i" title='i' data-ref="200i">i</a> - <var>1</var>];</td></tr>
<tr><th id="437">437</th><td>            <a class="local col1 ref" href="#201p" title='p' data-ref="201p">p</a>[<a class="local col0 ref" href="#200i" title='i' data-ref="200i">i</a>] = <a class="local col2 ref" href="#202b" title='b' data-ref="202b">b</a>;</td></tr>
<tr><th id="438">438</th><td>        }</td></tr>
<tr><th id="439">439</th><td>    }</td></tr>
<tr><th id="440">440</th><td>    <b>else</b></td></tr>
<tr><th id="441">441</th><td>        <a class="ref" href="../../include/exec/cpu-common.h.html#cpu_physical_memory_write" title='cpu_physical_memory_write' data-ref="cpu_physical_memory_write">cpu_physical_memory_write</a> (<a class="local col9 ref" href="#199addr" title='addr' data-ref="199addr">addr</a> + <a class="local col5 ref" href="#195pos" title='pos' data-ref="195pos">pos</a>, <a class="local col4 ref" href="#194buf" title='buf' data-ref="194buf">buf</a>, <a class="local col6 ref" href="#196len" title='len' data-ref="196len">len</a>);</td></tr>
<tr><th id="442">442</th><td></td></tr>
<tr><th id="443">443</th><td>    <b>return</b> <a class="local col6 ref" href="#196len" title='len' data-ref="196len">len</a>;</td></tr>
<tr><th id="444">444</th><td>}</td></tr>
<tr><th id="445">445</th><td></td></tr>
<tr><th id="446">446</th><td><i  data-doc="i8257_dma_schedule">/* request the emulator to transfer a new DMA memory block ASAP (even</i></td></tr>
<tr><th id="447">447</th><td><i  data-doc="i8257_dma_schedule"> * if the idle bottom half would not have exited the iothread yet).</i></td></tr>
<tr><th id="448">448</th><td><i  data-doc="i8257_dma_schedule"> */</i></td></tr>
<tr><th id="449">449</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="i8257_dma_schedule" title='i8257_dma_schedule' data-type='void i8257_dma_schedule(IsaDma * obj)' data-ref="i8257_dma_schedule">i8257_dma_schedule</dfn>(<a class="typedef" href="../../include/qemu/typedefs.h.html#IsaDma" title='IsaDma' data-type='struct IsaDma' data-ref="IsaDma">IsaDma</a> *<dfn class="local col3 decl" id="203obj" title='obj' data-type='IsaDma *' data-ref="203obj">obj</dfn>)</td></tr>
<tr><th id="450">450</th><td>{</td></tr>
<tr><th id="451">451</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col4 decl" id="204d" title='d' data-type='I8257State *' data-ref="204d">d</dfn> = <a class="macro" href="#31" title="((I8257State *)object_dynamic_cast_assert(((Object *)((obj))), (&quot;i8257&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 451, __func__))" data-ref="_M/I8257">I8257</a>(<a class="local col3 ref" href="#203obj" title='obj' data-ref="203obj">obj</a>);</td></tr>
<tr><th id="452">452</th><td>    <b>if</b> (<a class="local col4 ref" href="#204d" title='d' data-ref="204d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dma_bh_scheduled" title='I8257State::dma_bh_scheduled' data-ref="I8257State::dma_bh_scheduled">dma_bh_scheduled</a>) {</td></tr>
<tr><th id="453">453</th><td>        <a class="ref" href="../../include/qemu/main-loop.h.html#qemu_notify_event" title='qemu_notify_event' data-ref="qemu_notify_event">qemu_notify_event</a>();</td></tr>
<tr><th id="454">454</th><td>    }</td></tr>
<tr><th id="455">455</th><td>}</td></tr>
<tr><th id="456">456</th><td></td></tr>
<tr><th id="457">457</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="i8257_reset" title='i8257_reset' data-type='void i8257_reset(DeviceState * dev)' data-ref="i8257_reset">i8257_reset</dfn>(<a class="typedef" href="../../include/qemu/typedefs.h.html#DeviceState" title='DeviceState' data-type='struct DeviceState' data-ref="DeviceState">DeviceState</a> *<dfn class="local col5 decl" id="205dev" title='dev' data-type='DeviceState *' data-ref="205dev">dev</dfn>)</td></tr>
<tr><th id="458">458</th><td>{</td></tr>
<tr><th id="459">459</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col6 decl" id="206d" title='d' data-type='I8257State *' data-ref="206d">d</dfn> = <a class="macro" href="#31" title="((I8257State *)object_dynamic_cast_assert(((Object *)((dev))), (&quot;i8257&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 459, __func__))" data-ref="_M/I8257">I8257</a>(<a class="local col5 ref" href="#205dev" title='dev' data-ref="205dev">dev</a>);</td></tr>
<tr><th id="460">460</th><td>    <a class="tu ref" href="#i8257_write_cont" title='i8257_write_cont' data-use='c' data-ref="i8257_write_cont">i8257_write_cont</a>(<a class="local col6 ref" href="#206d" title='d' data-ref="206d">d</a>, (<var>0x05</var> &lt;&lt; <a class="local col6 ref" href="#206d" title='d' data-ref="206d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dshift" title='I8257State::dshift' data-ref="I8257State::dshift">dshift</a>), <var>0</var>, <var>1</var>);</td></tr>
<tr><th id="461">461</th><td>}</td></tr>
<tr><th id="462">462</th><td></td></tr>
<tr><th id="463">463</th><td><em>static</em> <em>int</em> <dfn class="tu decl def" id="i8257_phony_handler" title='i8257_phony_handler' data-type='int i8257_phony_handler(void * opaque, int nchan, int dma_pos, int dma_len)' data-ref="i8257_phony_handler">i8257_phony_handler</dfn>(<em>void</em> *<dfn class="local col7 decl" id="207opaque" title='opaque' data-type='void *' data-ref="207opaque">opaque</dfn>, <em>int</em> <dfn class="local col8 decl" id="208nchan" title='nchan' data-type='int' data-ref="208nchan">nchan</dfn>, <em>int</em> <dfn class="local col9 decl" id="209dma_pos" title='dma_pos' data-type='int' data-ref="209dma_pos">dma_pos</dfn>,</td></tr>
<tr><th id="464">464</th><td>                               <em>int</em> <dfn class="local col0 decl" id="210dma_len" title='dma_len' data-type='int' data-ref="210dma_len">dma_len</dfn>)</td></tr>
<tr><th id="465">465</th><td>{</td></tr>
<tr><th id="466">466</th><td>    <a class="ref" href="trace.h.html#trace_i8257_unregistered_dma" title='trace_i8257_unregistered_dma' data-ref="trace_i8257_unregistered_dma">trace_i8257_unregistered_dma</a>(<a class="local col8 ref" href="#208nchan" title='nchan' data-ref="208nchan">nchan</a>, <a class="local col9 ref" href="#209dma_pos" title='dma_pos' data-ref="209dma_pos">dma_pos</a>, <a class="local col0 ref" href="#210dma_len" title='dma_len' data-ref="210dma_len">dma_len</a>);</td></tr>
<tr><th id="467">467</th><td>    <b>return</b> <a class="local col9 ref" href="#209dma_pos" title='dma_pos' data-ref="209dma_pos">dma_pos</a>;</td></tr>
<tr><th id="468">468</th><td>}</td></tr>
<tr><th id="469">469</th><td></td></tr>
<tr><th id="470">470</th><td></td></tr>
<tr><th id="471">471</th><td><em>static</em> <em>const</em> <a class="typedef" href="../../include/exec/memory.h.html#MemoryRegionOps" title='MemoryRegionOps' data-type='struct MemoryRegionOps' data-ref="MemoryRegionOps">MemoryRegionOps</a> <dfn class="tu decl def" id="channel_io_ops" title='channel_io_ops' data-type='const MemoryRegionOps' data-ref="channel_io_ops">channel_io_ops</dfn> = {</td></tr>
<tr><th id="472">472</th><td>    .<a class="ref" href="../../include/exec/memory.h.html#MemoryRegionOps::read" title='MemoryRegionOps::read' data-ref="MemoryRegionOps::read">read</a> = <a class="tu ref" href="#i8257_read_chan" title='i8257_read_chan' data-ref="i8257_read_chan">i8257_read_chan</a>,</td></tr>
<tr><th id="473">473</th><td>    .<a class="ref" href="../../include/exec/memory.h.html#MemoryRegionOps::write" title='MemoryRegionOps::write' data-ref="MemoryRegionOps::write">write</a> = <a class="tu ref" href="#i8257_write_chan" title='i8257_write_chan' data-ref="i8257_write_chan">i8257_write_chan</a>,</td></tr>
<tr><th id="474">474</th><td>    .<a class="ref" href="../../include/exec/memory.h.html#MemoryRegionOps::endianness" title='MemoryRegionOps::endianness' data-ref="MemoryRegionOps::endianness">endianness</a> = <a class="enum" href="../../include/exec/cpu-common.h.html#device_endian::DEVICE_NATIVE_ENDIAN" title='device_endian::DEVICE_NATIVE_ENDIAN' data-ref="device_endian::DEVICE_NATIVE_ENDIAN">DEVICE_NATIVE_ENDIAN</a>,</td></tr>
<tr><th id="475">475</th><td>    .<a class="ref" href="../../include/exec/memory.h.html#MemoryRegionOps::impl" title='MemoryRegionOps::impl' data-ref="MemoryRegionOps::impl">impl</a> = {</td></tr>
<tr><th id="476">476</th><td>        .<a class="ref" href="../../include/exec/memory.h.html#MemoryRegionOps::(anonymous)::min_access_size" title='MemoryRegionOps::(anonymous struct)::min_access_size' data-ref="MemoryRegionOps::(anonymous)::min_access_size">min_access_size</a> = <var>1</var>,</td></tr>
<tr><th id="477">477</th><td>        .<a class="ref" href="../../include/exec/memory.h.html#MemoryRegionOps::(anonymous)::max_access_size" title='MemoryRegionOps::(anonymous struct)::max_access_size' data-ref="MemoryRegionOps::(anonymous)::max_access_size">max_access_size</a> = <var>1</var>,</td></tr>
<tr><th id="478">478</th><td>    },</td></tr>
<tr><th id="479">479</th><td>};</td></tr>
<tr><th id="480">480</th><td></td></tr>
<tr><th id="481">481</th><td><i  data-doc="page_portio_list">/* IOport from page_base */</i></td></tr>
<tr><th id="482">482</th><td><em>static</em> <em>const</em> <a class="typedef" href="../../include/exec/ioport.h.html#MemoryRegionPortio" title='MemoryRegionPortio' data-type='struct MemoryRegionPortio' data-ref="MemoryRegionPortio">MemoryRegionPortio</a> <dfn class="tu decl def" id="page_portio_list" title='page_portio_list' data-type='const MemoryRegionPortio [3]' data-ref="page_portio_list">page_portio_list</dfn>[] = {</td></tr>
<tr><th id="483">483</th><td>    { <var>0x01</var>, <var>3</var>, <var>1</var>, .<a class="ref" href="../../include/exec/ioport.h.html#MemoryRegionPortio::write" title='MemoryRegionPortio::write' data-ref="MemoryRegionPortio::write">write</a> = <a class="tu ref" href="#i8257_write_page" title='i8257_write_page' data-ref="i8257_write_page">i8257_write_page</a>, .<a class="ref" href="../../include/exec/ioport.h.html#MemoryRegionPortio::read" title='MemoryRegionPortio::read' data-ref="MemoryRegionPortio::read">read</a> = <a class="tu ref" href="#i8257_read_page" title='i8257_read_page' data-ref="i8257_read_page">i8257_read_page</a>, },</td></tr>
<tr><th id="484">484</th><td>    { <var>0x07</var>, <var>1</var>, <var>1</var>, .<a class="ref" href="../../include/exec/ioport.h.html#MemoryRegionPortio::write" title='MemoryRegionPortio::write' data-ref="MemoryRegionPortio::write">write</a> = <a class="tu ref" href="#i8257_write_page" title='i8257_write_page' data-ref="i8257_write_page">i8257_write_page</a>, .<a class="ref" href="../../include/exec/ioport.h.html#MemoryRegionPortio::read" title='MemoryRegionPortio::read' data-ref="MemoryRegionPortio::read">read</a> = <a class="tu ref" href="#i8257_read_page" title='i8257_read_page' data-ref="i8257_read_page">i8257_read_page</a>, },</td></tr>
<tr><th id="485">485</th><td>    <a class="macro" href="../../include/exec/ioport.h.html#39" title="{ }" data-ref="_M/PORTIO_END_OF_LIST">PORTIO_END_OF_LIST</a>(),</td></tr>
<tr><th id="486">486</th><td>};</td></tr>
<tr><th id="487">487</th><td></td></tr>
<tr><th id="488">488</th><td><i  data-doc="pageh_portio_list">/* IOport from pageh_base */</i></td></tr>
<tr><th id="489">489</th><td><em>static</em> <em>const</em> <a class="typedef" href="../../include/exec/ioport.h.html#MemoryRegionPortio" title='MemoryRegionPortio' data-type='struct MemoryRegionPortio' data-ref="MemoryRegionPortio">MemoryRegionPortio</a> <dfn class="tu decl def" id="pageh_portio_list" title='pageh_portio_list' data-type='const MemoryRegionPortio [3]' data-ref="pageh_portio_list">pageh_portio_list</dfn>[] = {</td></tr>
<tr><th id="490">490</th><td>    { <var>0x01</var>, <var>3</var>, <var>1</var>, .<a class="ref" href="../../include/exec/ioport.h.html#MemoryRegionPortio::write" title='MemoryRegionPortio::write' data-ref="MemoryRegionPortio::write">write</a> = <a class="tu ref" href="#i8257_write_pageh" title='i8257_write_pageh' data-ref="i8257_write_pageh">i8257_write_pageh</a>, .<a class="ref" href="../../include/exec/ioport.h.html#MemoryRegionPortio::read" title='MemoryRegionPortio::read' data-ref="MemoryRegionPortio::read">read</a> = <a class="tu ref" href="#i8257_read_pageh" title='i8257_read_pageh' data-ref="i8257_read_pageh">i8257_read_pageh</a>, },</td></tr>
<tr><th id="491">491</th><td>    { <var>0x07</var>, <var>3</var>, <var>1</var>, .<a class="ref" href="../../include/exec/ioport.h.html#MemoryRegionPortio::write" title='MemoryRegionPortio::write' data-ref="MemoryRegionPortio::write">write</a> = <a class="tu ref" href="#i8257_write_pageh" title='i8257_write_pageh' data-ref="i8257_write_pageh">i8257_write_pageh</a>, .<a class="ref" href="../../include/exec/ioport.h.html#MemoryRegionPortio::read" title='MemoryRegionPortio::read' data-ref="MemoryRegionPortio::read">read</a> = <a class="tu ref" href="#i8257_read_pageh" title='i8257_read_pageh' data-ref="i8257_read_pageh">i8257_read_pageh</a>, },</td></tr>
<tr><th id="492">492</th><td>    <a class="macro" href="../../include/exec/ioport.h.html#39" title="{ }" data-ref="_M/PORTIO_END_OF_LIST">PORTIO_END_OF_LIST</a>(),</td></tr>
<tr><th id="493">493</th><td>};</td></tr>
<tr><th id="494">494</th><td></td></tr>
<tr><th id="495">495</th><td><em>static</em> <em>const</em> <a class="typedef" href="../../include/exec/memory.h.html#MemoryRegionOps" title='MemoryRegionOps' data-type='struct MemoryRegionOps' data-ref="MemoryRegionOps">MemoryRegionOps</a> <dfn class="tu decl def" id="cont_io_ops" title='cont_io_ops' data-type='const MemoryRegionOps' data-ref="cont_io_ops">cont_io_ops</dfn> = {</td></tr>
<tr><th id="496">496</th><td>    .<a class="ref" href="../../include/exec/memory.h.html#MemoryRegionOps::read" title='MemoryRegionOps::read' data-ref="MemoryRegionOps::read">read</a> = <a class="tu ref" href="#i8257_read_cont" title='i8257_read_cont' data-ref="i8257_read_cont">i8257_read_cont</a>,</td></tr>
<tr><th id="497">497</th><td>    .<a class="ref" href="../../include/exec/memory.h.html#MemoryRegionOps::write" title='MemoryRegionOps::write' data-ref="MemoryRegionOps::write">write</a> = <a class="tu ref" href="#i8257_write_cont" title='i8257_write_cont' data-ref="i8257_write_cont">i8257_write_cont</a>,</td></tr>
<tr><th id="498">498</th><td>    .<a class="ref" href="../../include/exec/memory.h.html#MemoryRegionOps::endianness" title='MemoryRegionOps::endianness' data-ref="MemoryRegionOps::endianness">endianness</a> = <a class="enum" href="../../include/exec/cpu-common.h.html#device_endian::DEVICE_NATIVE_ENDIAN" title='device_endian::DEVICE_NATIVE_ENDIAN' data-ref="device_endian::DEVICE_NATIVE_ENDIAN">DEVICE_NATIVE_ENDIAN</a>,</td></tr>
<tr><th id="499">499</th><td>    .<a class="ref" href="../../include/exec/memory.h.html#MemoryRegionOps::impl" title='MemoryRegionOps::impl' data-ref="MemoryRegionOps::impl">impl</a> = {</td></tr>
<tr><th id="500">500</th><td>        .<a class="ref" href="../../include/exec/memory.h.html#MemoryRegionOps::(anonymous)::min_access_size" title='MemoryRegionOps::(anonymous struct)::min_access_size' data-ref="MemoryRegionOps::(anonymous)::min_access_size">min_access_size</a> = <var>1</var>,</td></tr>
<tr><th id="501">501</th><td>        .<a class="ref" href="../../include/exec/memory.h.html#MemoryRegionOps::(anonymous)::max_access_size" title='MemoryRegionOps::(anonymous struct)::max_access_size' data-ref="MemoryRegionOps::(anonymous)::max_access_size">max_access_size</a> = <var>1</var>,</td></tr>
<tr><th id="502">502</th><td>    },</td></tr>
<tr><th id="503">503</th><td>};</td></tr>
<tr><th id="504">504</th><td></td></tr>
<tr><th id="505">505</th><td><em>static</em> <em>const</em> <a class="typedef" href="../../include/migration/vmstate.h.html#VMStateDescription" title='VMStateDescription' data-type='struct VMStateDescription' data-ref="VMStateDescription">VMStateDescription</a> <dfn class="tu decl def" id="vmstate_i8257_regs" title='vmstate_i8257_regs' data-type='const VMStateDescription' data-ref="vmstate_i8257_regs">vmstate_i8257_regs</dfn> = {</td></tr>
<tr><th id="506">506</th><td>    .<a class="ref" href="../../include/migration/vmstate.h.html#VMStateDescription::name" title='VMStateDescription::name' data-ref="VMStateDescription::name">name</a> = <q>"dma_regs"</q>,</td></tr>
<tr><th id="507">507</th><td>    .<a class="ref" href="../../include/migration/vmstate.h.html#VMStateDescription::version_id" title='VMStateDescription::version_id' data-ref="VMStateDescription::version_id">version_id</a> = <var>1</var>,</td></tr>
<tr><th id="508">508</th><td>    .<a class="ref" href="../../include/migration/vmstate.h.html#VMStateDescription::minimum_version_id" title='VMStateDescription::minimum_version_id' data-ref="VMStateDescription::minimum_version_id">minimum_version_id</a> = <var>1</var>,</td></tr>
<tr><th id="509">509</th><td>    .<a class="ref" href="../../include/migration/vmstate.h.html#VMStateDescription::fields" title='VMStateDescription::fields' data-ref="VMStateDescription::fields">fields</a> = (<a class="typedef" href="../../include/migration/vmstate.h.html#VMStateField" title='VMStateField' data-type='struct VMStateField' data-ref="VMStateField">VMStateField</a>[]) {</td></tr>
<tr><th id="510">510</th><td>        <a class="macro" href="../../include/migration/vmstate.h.html#932" title="{ .name = (&quot;now&quot;), .version_id = (0), .num = (2), .info = &amp;(vmstate_info_int32), .size = sizeof(int32_t), .flags = VMS_ARRAY, .offset = (__builtin_offsetof(I8257Regs, now) + ((int32_t(*)[2])0 - (typeof(((I8257Regs *)0)-&gt;now)*)0)), }" data-ref="_M/VMSTATE_INT32_ARRAY">VMSTATE_INT32_ARRAY</a>(<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::now" title='I8257Regs::now' data-ref="I8257Regs::now">now</a>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a>, <var>2</var>),</td></tr>
<tr><th id="511">511</th><td>        <a class="macro" href="../../include/migration/vmstate.h.html#878" title="{ .name = (&quot;base&quot;), .version_id = (0), .num = (2), .info = &amp;(vmstate_info_uint16), .size = sizeof(uint16_t), .flags = VMS_ARRAY, .offset = (__builtin_offsetof(I8257Regs, base) + ((uint16_t(*)[2])0 - (typeof(((I8257Regs *)0)-&gt;base)*)0)), }" data-ref="_M/VMSTATE_UINT16_ARRAY">VMSTATE_UINT16_ARRAY</a>(<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::base" title='I8257Regs::base' data-ref="I8257Regs::base">base</a>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a>, <var>2</var>),</td></tr>
<tr><th id="512">512</th><td>        <a class="macro" href="../../include/migration/vmstate.h.html#769" title="{ .name = (&quot;mode&quot;), .version_id = (0), .field_exists = (((void*)0)), .size = sizeof(uint8_t), .info = &amp;(vmstate_info_uint8), .flags = VMS_SINGLE, .offset = (__builtin_offsetof(I8257Regs, mode) + ((uint8_t*)0 - (typeof(((I8257Regs *)0)-&gt;mode)*)0)), }" data-ref="_M/VMSTATE_UINT8">VMSTATE_UINT8</a>(<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::mode" title='I8257Regs::mode' data-ref="I8257Regs::mode">mode</a>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a>),</td></tr>
<tr><th id="513">513</th><td>        <a class="macro" href="../../include/migration/vmstate.h.html#769" title="{ .name = (&quot;page&quot;), .version_id = (0), .field_exists = (((void*)0)), .size = sizeof(uint8_t), .info = &amp;(vmstate_info_uint8), .flags = VMS_SINGLE, .offset = (__builtin_offsetof(I8257Regs, page) + ((uint8_t*)0 - (typeof(((I8257Regs *)0)-&gt;page)*)0)), }" data-ref="_M/VMSTATE_UINT8">VMSTATE_UINT8</a>(<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::page" title='I8257Regs::page' data-ref="I8257Regs::page">page</a>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a>),</td></tr>
<tr><th id="514">514</th><td>        <a class="macro" href="../../include/migration/vmstate.h.html#769" title="{ .name = (&quot;pageh&quot;), .version_id = (0), .field_exists = (((void*)0)), .size = sizeof(uint8_t), .info = &amp;(vmstate_info_uint8), .flags = VMS_SINGLE, .offset = (__builtin_offsetof(I8257Regs, pageh) + ((uint8_t*)0 - (typeof(((I8257Regs *)0)-&gt;pageh)*)0)), }" data-ref="_M/VMSTATE_UINT8">VMSTATE_UINT8</a>(<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::pageh" title='I8257Regs::pageh' data-ref="I8257Regs::pageh">pageh</a>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a>),</td></tr>
<tr><th id="515">515</th><td>        <a class="macro" href="../../include/migration/vmstate.h.html#769" title="{ .name = (&quot;dack&quot;), .version_id = (0), .field_exists = (((void*)0)), .size = sizeof(uint8_t), .info = &amp;(vmstate_info_uint8), .flags = VMS_SINGLE, .offset = (__builtin_offsetof(I8257Regs, dack) + ((uint8_t*)0 - (typeof(((I8257Regs *)0)-&gt;dack)*)0)), }" data-ref="_M/VMSTATE_UINT8">VMSTATE_UINT8</a>(<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::dack" title='I8257Regs::dack' data-ref="I8257Regs::dack">dack</a>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a>),</td></tr>
<tr><th id="516">516</th><td>        <a class="macro" href="../../include/migration/vmstate.h.html#769" title="{ .name = (&quot;eop&quot;), .version_id = (0), .field_exists = (((void*)0)), .size = sizeof(uint8_t), .info = &amp;(vmstate_info_uint8), .flags = VMS_SINGLE, .offset = (__builtin_offsetof(I8257Regs, eop) + ((uint8_t*)0 - (typeof(((I8257Regs *)0)-&gt;eop)*)0)), }" data-ref="_M/VMSTATE_UINT8">VMSTATE_UINT8</a>(<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::eop" title='I8257Regs::eop' data-ref="I8257Regs::eop">eop</a>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a>),</td></tr>
<tr><th id="517">517</th><td>        <a class="macro" href="../../include/migration/vmstate.h.html#992" title="{}" data-ref="_M/VMSTATE_END_OF_LIST">VMSTATE_END_OF_LIST</a>()</td></tr>
<tr><th id="518">518</th><td>    }</td></tr>
<tr><th id="519">519</th><td>};</td></tr>
<tr><th id="520">520</th><td></td></tr>
<tr><th id="521">521</th><td><em>static</em> <em>int</em> <dfn class="tu decl def" id="i8257_post_load" title='i8257_post_load' data-type='int i8257_post_load(void * opaque, int version_id)' data-ref="i8257_post_load">i8257_post_load</dfn>(<em>void</em> *<dfn class="local col1 decl" id="211opaque" title='opaque' data-type='void *' data-ref="211opaque">opaque</dfn>, <em>int</em> <dfn class="local col2 decl" id="212version_id" title='version_id' data-type='int' data-ref="212version_id">version_id</dfn>)</td></tr>
<tr><th id="522">522</th><td>{</td></tr>
<tr><th id="523">523</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col3 decl" id="213d" title='d' data-type='I8257State *' data-ref="213d">d</dfn> = <a class="local col1 ref" href="#211opaque" title='opaque' data-ref="211opaque">opaque</a>;</td></tr>
<tr><th id="524">524</th><td>    <a class="tu ref" href="#i8257_dma_run" title='i8257_dma_run' data-use='c' data-ref="i8257_dma_run">i8257_dma_run</a>(<a class="local col3 ref" href="#213d" title='d' data-ref="213d">d</a>);</td></tr>
<tr><th id="525">525</th><td></td></tr>
<tr><th id="526">526</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="527">527</th><td>}</td></tr>
<tr><th id="528">528</th><td></td></tr>
<tr><th id="529">529</th><td><em>static</em> <em>const</em> <a class="typedef" href="../../include/migration/vmstate.h.html#VMStateDescription" title='VMStateDescription' data-type='struct VMStateDescription' data-ref="VMStateDescription">VMStateDescription</a> <dfn class="tu decl def" id="vmstate_i8257" title='vmstate_i8257' data-type='const VMStateDescription' data-ref="vmstate_i8257">vmstate_i8257</dfn> = {</td></tr>
<tr><th id="530">530</th><td>    .<a class="ref" href="../../include/migration/vmstate.h.html#VMStateDescription::name" title='VMStateDescription::name' data-ref="VMStateDescription::name">name</a> = <q>"dma"</q>,</td></tr>
<tr><th id="531">531</th><td>    .<a class="ref" href="../../include/migration/vmstate.h.html#VMStateDescription::version_id" title='VMStateDescription::version_id' data-ref="VMStateDescription::version_id">version_id</a> = <var>1</var>,</td></tr>
<tr><th id="532">532</th><td>    .<a class="ref" href="../../include/migration/vmstate.h.html#VMStateDescription::minimum_version_id" title='VMStateDescription::minimum_version_id' data-ref="VMStateDescription::minimum_version_id">minimum_version_id</a> = <var>1</var>,</td></tr>
<tr><th id="533">533</th><td>    .<a class="ref" href="../../include/migration/vmstate.h.html#VMStateDescription::post_load" title='VMStateDescription::post_load' data-ref="VMStateDescription::post_load">post_load</a> = <a class="tu ref" href="#i8257_post_load" title='i8257_post_load' data-ref="i8257_post_load">i8257_post_load</a>,</td></tr>
<tr><th id="534">534</th><td>    .<a class="ref" href="../../include/migration/vmstate.h.html#VMStateDescription::fields" title='VMStateDescription::fields' data-ref="VMStateDescription::fields">fields</a> = (<a class="typedef" href="../../include/migration/vmstate.h.html#VMStateField" title='VMStateField' data-type='struct VMStateField' data-ref="VMStateField">VMStateField</a>[]) {</td></tr>
<tr><th id="535">535</th><td>        <a class="macro" href="../../include/migration/vmstate.h.html#769" title="{ .name = (&quot;command&quot;), .version_id = (0), .field_exists = (((void*)0)), .size = sizeof(uint8_t), .info = &amp;(vmstate_info_uint8), .flags = VMS_SINGLE, .offset = (__builtin_offsetof(I8257State, command) + ((uint8_t*)0 - (typeof(((I8257State *)0)-&gt;command)*)0)), }" data-ref="_M/VMSTATE_UINT8">VMSTATE_UINT8</a>(<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::command" title='I8257State::command' data-ref="I8257State::command">command</a>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a>),</td></tr>
<tr><th id="536">536</th><td>        <a class="macro" href="../../include/migration/vmstate.h.html#769" title="{ .name = (&quot;mask&quot;), .version_id = (0), .field_exists = (((void*)0)), .size = sizeof(uint8_t), .info = &amp;(vmstate_info_uint8), .flags = VMS_SINGLE, .offset = (__builtin_offsetof(I8257State, mask) + ((uint8_t*)0 - (typeof(((I8257State *)0)-&gt;mask)*)0)), }" data-ref="_M/VMSTATE_UINT8">VMSTATE_UINT8</a>(<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::mask" title='I8257State::mask' data-ref="I8257State::mask">mask</a>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a>),</td></tr>
<tr><th id="537">537</th><td>        <a class="macro" href="../../include/migration/vmstate.h.html#769" title="{ .name = (&quot;flip_flop&quot;), .version_id = (0), .field_exists = (((void*)0)), .size = sizeof(uint8_t), .info = &amp;(vmstate_info_uint8), .flags = VMS_SINGLE, .offset = (__builtin_offsetof(I8257State, flip_flop) + ((uint8_t*)0 - (typeof(((I8257State *)0)-&gt;flip_flop)*)0)), }" data-ref="_M/VMSTATE_UINT8">VMSTATE_UINT8</a>(<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::flip_flop" title='I8257State::flip_flop' data-ref="I8257State::flip_flop">flip_flop</a>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a>),</td></tr>
<tr><th id="538">538</th><td>        <a class="macro" href="../../include/migration/vmstate.h.html#764" title="{ .name = (&quot;dshift&quot;), .version_id = (0), .field_exists = (((void*)0)), .size = sizeof(int32_t), .info = &amp;(vmstate_info_int32), .flags = VMS_SINGLE, .offset = (__builtin_offsetof(I8257State, dshift) + ((int32_t*)0 - (typeof(((I8257State *)0)-&gt;dshift)*)0)), }" data-ref="_M/VMSTATE_INT32">VMSTATE_INT32</a>(<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dshift" title='I8257State::dshift' data-ref="I8257State::dshift">dshift</a>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a>),</td></tr>
<tr><th id="539">539</th><td>        <a class="macro" href="../../include/migration/vmstate.h.html#723" title="{ .name = (&quot;regs&quot;), .num = (4), .field_exists = (((void*)0)), .version_id = (1), .vmsd = &amp;(vmstate_i8257_regs), .size = sizeof(I8257Regs), .flags = VMS_STRUCT|VMS_ARRAY, .offset = (__builtin_offsetof(I8257State, regs) + ((I8257Regs(*)[4])0 - (typeof(((I8257State *)0)-&gt;regs)*)0)),}" data-ref="_M/VMSTATE_STRUCT_ARRAY">VMSTATE_STRUCT_ARRAY</a>(<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a>, <var>4</var>, <var>1</var>, <a class="tu ref" href="#vmstate_i8257_regs" title='vmstate_i8257_regs' data-use='a' data-ref="vmstate_i8257_regs">vmstate_i8257_regs</a>,</td></tr>
<tr><th id="540">540</th><td>                             <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257Regs" title='I8257Regs' data-type='struct I8257Regs' data-ref="I8257Regs">I8257Regs</a>),</td></tr>
<tr><th id="541">541</th><td>        <a class="macro" href="../../include/migration/vmstate.h.html#992" title="{}" data-ref="_M/VMSTATE_END_OF_LIST">VMSTATE_END_OF_LIST</a>()</td></tr>
<tr><th id="542">542</th><td>    }</td></tr>
<tr><th id="543">543</th><td>};</td></tr>
<tr><th id="544">544</th><td></td></tr>
<tr><th id="545">545</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="i8257_realize" title='i8257_realize' data-type='void i8257_realize(DeviceState * dev, Error ** errp)' data-ref="i8257_realize">i8257_realize</dfn>(<a class="typedef" href="../../include/qemu/typedefs.h.html#DeviceState" title='DeviceState' data-type='struct DeviceState' data-ref="DeviceState">DeviceState</a> *<dfn class="local col4 decl" id="214dev" title='dev' data-type='DeviceState *' data-ref="214dev">dev</dfn>, <a class="typedef" href="../../include/qemu/typedefs.h.html#Error" title='Error' data-type='struct Error' data-ref="Error">Error</a> **<dfn class="local col5 decl" id="215errp" title='errp' data-type='Error **' data-ref="215errp">errp</dfn>)</td></tr>
<tr><th id="546">546</th><td>{</td></tr>
<tr><th id="547">547</th><td>    <a class="typedef" href="../../include/qemu/typedefs.h.html#ISADevice" title='ISADevice' data-type='struct ISADevice' data-ref="ISADevice">ISADevice</a> *<dfn class="local col6 decl" id="216isa" title='isa' data-type='ISADevice *' data-ref="216isa">isa</dfn> = <a class="macro" href="../../include/hw/isa/isa.h.html#13" title="((ISADevice *)object_dynamic_cast_assert(((Object *)((dev))), (&quot;isa-device&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 547, __func__))" data-ref="_M/ISA_DEVICE">ISA_DEVICE</a>(<a class="local col4 ref" href="#214dev" title='dev' data-ref="214dev">dev</a>);</td></tr>
<tr><th id="548">548</th><td>    <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a> *<dfn class="local col7 decl" id="217d" title='d' data-type='I8257State *' data-ref="217d">d</dfn> = <a class="macro" href="#31" title="((I8257State *)object_dynamic_cast_assert(((Object *)((dev))), (&quot;i8257&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 548, __func__))" data-ref="_M/I8257">I8257</a>(<a class="local col4 ref" href="#214dev" title='dev' data-ref="214dev">dev</a>);</td></tr>
<tr><th id="549">549</th><td>    <em>int</em> <dfn class="local col8 decl" id="218i" title='i' data-type='int' data-ref="218i">i</dfn>;</td></tr>
<tr><th id="550">550</th><td></td></tr>
<tr><th id="551">551</th><td>    <a class="ref" href="../../include/exec/memory.h.html#memory_region_init_io" title='memory_region_init_io' data-ref="memory_region_init_io">memory_region_init_io</a>(&amp;<a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::channel_io" title='I8257State::channel_io' data-ref="I8257State::channel_io">channel_io</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, &amp;<a class="tu ref" href="#channel_io_ops" title='channel_io_ops' data-use='a' data-ref="channel_io_ops">channel_io_ops</a>, <a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>,</td></tr>
<tr><th id="552">552</th><td>                          <q>"dma-chan"</q>, <var>8</var> &lt;&lt; <a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dshift" title='I8257State::dshift' data-ref="I8257State::dshift">dshift</a>);</td></tr>
<tr><th id="553">553</th><td>    <a class="ref" href="../../include/exec/memory.h.html#memory_region_add_subregion" title='memory_region_add_subregion' data-ref="memory_region_add_subregion">memory_region_add_subregion</a>(<a class="ref" href="../../include/hw/isa/isa.h.html#isa_address_space_io" title='isa_address_space_io' data-ref="isa_address_space_io">isa_address_space_io</a>(<a class="local col6 ref" href="#216isa" title='isa' data-ref="216isa">isa</a>),</td></tr>
<tr><th id="554">554</th><td>                                <a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::base" title='I8257State::base' data-ref="I8257State::base">base</a>, &amp;<a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::channel_io" title='I8257State::channel_io' data-ref="I8257State::channel_io">channel_io</a>);</td></tr>
<tr><th id="555">555</th><td></td></tr>
<tr><th id="556">556</th><td>    <a class="ref" href="../../include/hw/isa/isa.h.html#isa_register_portio_list" title='isa_register_portio_list' data-ref="isa_register_portio_list">isa_register_portio_list</a>(<a class="local col6 ref" href="#216isa" title='isa' data-ref="216isa">isa</a>, &amp;<a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::portio_page" title='I8257State::portio_page' data-ref="I8257State::portio_page">portio_page</a>,</td></tr>
<tr><th id="557">557</th><td>                             <a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::page_base" title='I8257State::page_base' data-ref="I8257State::page_base">page_base</a>, <a class="tu ref" href="#page_portio_list" title='page_portio_list' data-use='r' data-ref="page_portio_list">page_portio_list</a>, <a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>,</td></tr>
<tr><th id="558">558</th><td>                             <q>"dma-page"</q>);</td></tr>
<tr><th id="559">559</th><td>    <b>if</b> (<a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::pageh_base" title='I8257State::pageh_base' data-ref="I8257State::pageh_base">pageh_base</a> &gt;= <var>0</var>) {</td></tr>
<tr><th id="560">560</th><td>        <a class="ref" href="../../include/hw/isa/isa.h.html#isa_register_portio_list" title='isa_register_portio_list' data-ref="isa_register_portio_list">isa_register_portio_list</a>(<a class="local col6 ref" href="#216isa" title='isa' data-ref="216isa">isa</a>, &amp;<a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::portio_pageh" title='I8257State::portio_pageh' data-ref="I8257State::portio_pageh">portio_pageh</a>,</td></tr>
<tr><th id="561">561</th><td>                                 <a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::pageh_base" title='I8257State::pageh_base' data-ref="I8257State::pageh_base">pageh_base</a>, <a class="tu ref" href="#pageh_portio_list" title='pageh_portio_list' data-use='r' data-ref="pageh_portio_list">pageh_portio_list</a>, <a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>,</td></tr>
<tr><th id="562">562</th><td>                                 <q>"dma-pageh"</q>);</td></tr>
<tr><th id="563">563</th><td>    }</td></tr>
<tr><th id="564">564</th><td></td></tr>
<tr><th id="565">565</th><td>    <a class="ref" href="../../include/exec/memory.h.html#memory_region_init_io" title='memory_region_init_io' data-ref="memory_region_init_io">memory_region_init_io</a>(&amp;<a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::cont_io" title='I8257State::cont_io' data-ref="I8257State::cont_io">cont_io</a>, <a class="macro" href="../../include/qom/object.h.html#473" title="((Object *)(isa))" data-ref="_M/OBJECT">OBJECT</a>(<a class="local col6 ref" href="#216isa" title='isa' data-ref="216isa">isa</a>), &amp;<a class="tu ref" href="#cont_io_ops" title='cont_io_ops' data-use='a' data-ref="cont_io_ops">cont_io_ops</a>, <a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>,</td></tr>
<tr><th id="566">566</th><td>                          <q>"dma-cont"</q>, <var>8</var> &lt;&lt; <a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dshift" title='I8257State::dshift' data-ref="I8257State::dshift">dshift</a>);</td></tr>
<tr><th id="567">567</th><td>    <a class="ref" href="../../include/exec/memory.h.html#memory_region_add_subregion" title='memory_region_add_subregion' data-ref="memory_region_add_subregion">memory_region_add_subregion</a>(<a class="ref" href="../../include/hw/isa/isa.h.html#isa_address_space_io" title='isa_address_space_io' data-ref="isa_address_space_io">isa_address_space_io</a>(<a class="local col6 ref" href="#216isa" title='isa' data-ref="216isa">isa</a>),</td></tr>
<tr><th id="568">568</th><td>                                <a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::base" title='I8257State::base' data-ref="I8257State::base">base</a> + (<var>8</var> &lt;&lt; <a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dshift" title='I8257State::dshift' data-ref="I8257State::dshift">dshift</a>), &amp;<a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::cont_io" title='I8257State::cont_io' data-ref="I8257State::cont_io">cont_io</a>);</td></tr>
<tr><th id="569">569</th><td></td></tr>
<tr><th id="570">570</th><td>    <b>for</b> (<a class="local col8 ref" href="#218i" title='i' data-ref="218i">i</a> = <var>0</var>; <a class="local col8 ref" href="#218i" title='i' data-ref="218i">i</a> &lt; <a class="macro" href="../../include/qemu/osdep.h.html#208" title="((sizeof(d-&gt;regs) / sizeof((d-&gt;regs)[0])) + (sizeof(struct { int:(!(!__builtin_types_compatible_p(typeof(d-&gt;regs), typeof(&amp;(d-&gt;regs)[0])))) ? -1 : 1; }) - sizeof(struct { int:(!(!__builtin_types_compatible_p(typeof(d-&gt;regs), typeof(&amp;(d-&gt;regs)[0])))) ? -1 : 1; })))" data-ref="_M/ARRAY_SIZE">ARRAY_SIZE</a>(<a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a>); ++<a class="local col8 ref" href="#218i" title='i' data-ref="218i">i</a>) {</td></tr>
<tr><th id="571">571</th><td>        <a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::regs" title='I8257State::regs' data-ref="I8257State::regs">regs</a>[<a class="local col8 ref" href="#218i" title='i' data-ref="218i">i</a>].<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257Regs::transfer_handler" title='I8257Regs::transfer_handler' data-ref="I8257Regs::transfer_handler">transfer_handler</a> = <a class="tu ref" href="#i8257_phony_handler" title='i8257_phony_handler' data-use='r' data-ref="i8257_phony_handler">i8257_phony_handler</a>;</td></tr>
<tr><th id="572">572</th><td>    }</td></tr>
<tr><th id="573">573</th><td></td></tr>
<tr><th id="574">574</th><td>    <a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>-&gt;<a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dma_bh" title='I8257State::dma_bh' data-ref="I8257State::dma_bh">dma_bh</a> = <a class="ref" href="../../include/qemu/main-loop.h.html#qemu_bh_new" title='qemu_bh_new' data-ref="qemu_bh_new">qemu_bh_new</a>(<a class="tu ref" href="#i8257_dma_run" title='i8257_dma_run' data-use='r' data-ref="i8257_dma_run">i8257_dma_run</a>, <a class="local col7 ref" href="#217d" title='d' data-ref="217d">d</a>);</td></tr>
<tr><th id="575">575</th><td>}</td></tr>
<tr><th id="576">576</th><td></td></tr>
<tr><th id="577">577</th><td><em>static</em> <a class="typedef" href="../../include/qemu/typedefs.h.html#Property" title='Property' data-type='struct Property' data-ref="Property">Property</a> <dfn class="tu decl def" id="i8257_properties" title='i8257_properties' data-type='Property [5]' data-ref="i8257_properties">i8257_properties</dfn>[] = {</td></tr>
<tr><th id="578">578</th><td>    <a class="macro" href="../../include/hw/qdev-properties.h.html#157" title="{ .name = (&quot;base&quot;), .info = &amp;(qdev_prop_int32), .offset = __builtin_offsetof(I8257State, base) + ((int32_t*)0 - (typeof(((I8257State *)0)-&gt;base)*)0), .set_default = 1, .defval.i = (int32_t)0x00, }" data-ref="_M/DEFINE_PROP_INT32">DEFINE_PROP_INT32</a>(<q>"base"</q>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a>, <a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::base" title='I8257State::base' data-ref="I8257State::base">base</a>, <var>0x00</var>),</td></tr>
<tr><th id="579">579</th><td>    <a class="macro" href="../../include/hw/qdev-properties.h.html#157" title="{ .name = (&quot;page-base&quot;), .info = &amp;(qdev_prop_int32), .offset = __builtin_offsetof(I8257State, page_base) + ((int32_t*)0 - (typeof(((I8257State *)0)-&gt;page_base)*)0), .set_default = 1, .defval.i = (int32_t)0x80, }" data-ref="_M/DEFINE_PROP_INT32">DEFINE_PROP_INT32</a>(<q>"page-base"</q>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a>, <a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::page_base" title='I8257State::page_base' data-ref="I8257State::page_base">page_base</a>, <var>0x80</var>),</td></tr>
<tr><th id="580">580</th><td>    <a class="macro" href="../../include/hw/qdev-properties.h.html#157" title="{ .name = (&quot;pageh-base&quot;), .info = &amp;(qdev_prop_int32), .offset = __builtin_offsetof(I8257State, pageh_base) + ((int32_t*)0 - (typeof(((I8257State *)0)-&gt;pageh_base)*)0), .set_default = 1, .defval.i = (int32_t)0x480, }" data-ref="_M/DEFINE_PROP_INT32">DEFINE_PROP_INT32</a>(<q>"pageh-base"</q>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a>, <a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::pageh_base" title='I8257State::pageh_base' data-ref="I8257State::pageh_base">pageh_base</a>, <var>0x480</var>),</td></tr>
<tr><th id="581">581</th><td>    <a class="macro" href="../../include/hw/qdev-properties.h.html#157" title="{ .name = (&quot;dshift&quot;), .info = &amp;(qdev_prop_int32), .offset = __builtin_offsetof(I8257State, dshift) + ((int32_t*)0 - (typeof(((I8257State *)0)-&gt;dshift)*)0), .set_default = 1, .defval.i = (int32_t)0, }" data-ref="_M/DEFINE_PROP_INT32">DEFINE_PROP_INT32</a>(<q>"dshift"</q>, <a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a>, <a class="ref" href="../../include/hw/isa/i8257.h.html#I8257State::dshift" title='I8257State::dshift' data-ref="I8257State::dshift">dshift</a>, <var>0</var>),</td></tr>
<tr><th id="582">582</th><td>    <a class="macro" href="../../include/hw/qdev-properties.h.html#216" title="{}" data-ref="_M/DEFINE_PROP_END_OF_LIST">DEFINE_PROP_END_OF_LIST</a>()</td></tr>
<tr><th id="583">583</th><td>};</td></tr>
<tr><th id="584">584</th><td></td></tr>
<tr><th id="585">585</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="i8257_class_init" title='i8257_class_init' data-type='void i8257_class_init(ObjectClass * klass, void * data)' data-ref="i8257_class_init">i8257_class_init</dfn>(<a class="typedef" href="../../include/qom/object.h.html#ObjectClass" title='ObjectClass' data-type='struct ObjectClass' data-ref="ObjectClass">ObjectClass</a> *<dfn class="local col9 decl" id="219klass" title='klass' data-type='ObjectClass *' data-ref="219klass">klass</dfn>, <em>void</em> *<dfn class="local col0 decl" id="220data" title='data' data-type='void *' data-ref="220data">data</dfn>)</td></tr>
<tr><th id="586">586</th><td>{</td></tr>
<tr><th id="587">587</th><td>    <a class="typedef" href="../../include/hw/qdev-core.h.html#DeviceClass" title='DeviceClass' data-type='struct DeviceClass' data-ref="DeviceClass">DeviceClass</a> *<dfn class="local col1 decl" id="221dc" title='dc' data-type='DeviceClass *' data-ref="221dc">dc</dfn> = <a class="macro" href="../../include/hw/qdev-core.h.html#17" title="((DeviceClass *)object_class_dynamic_cast_assert(((ObjectClass *)((klass))), (&quot;device&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 587, __func__))" data-ref="_M/DEVICE_CLASS">DEVICE_CLASS</a>(<a class="local col9 ref" href="#219klass" title='klass' data-ref="219klass">klass</a>);</td></tr>
<tr><th id="588">588</th><td>    <a class="typedef" href="../../include/hw/isa/isa.h.html#IsaDmaClass" title='IsaDmaClass' data-type='struct IsaDmaClass' data-ref="IsaDmaClass">IsaDmaClass</a> *<dfn class="local col2 decl" id="222idc" title='idc' data-type='IsaDmaClass *' data-ref="222idc">idc</dfn> = <a class="macro" href="../../include/hw/isa/isa.h.html#39" title="((IsaDmaClass *)object_class_dynamic_cast_assert(((ObjectClass *)((klass))), (&quot;isa-dma&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 588, __func__))" data-ref="_M/ISADMA_CLASS">ISADMA_CLASS</a>(<a class="local col9 ref" href="#219klass" title='klass' data-ref="219klass">klass</a>);</td></tr>
<tr><th id="589">589</th><td></td></tr>
<tr><th id="590">590</th><td>    <a class="local col1 ref" href="#221dc" title='dc' data-ref="221dc">dc</a>-&gt;<a class="ref" href="../../include/hw/qdev-core.h.html#DeviceClass::realize" title='DeviceClass::realize' data-ref="DeviceClass::realize">realize</a> = <a class="tu ref" href="#i8257_realize" title='i8257_realize' data-use='r' data-ref="i8257_realize">i8257_realize</a>;</td></tr>
<tr><th id="591">591</th><td>    <a class="local col1 ref" href="#221dc" title='dc' data-ref="221dc">dc</a>-&gt;<a class="ref" href="../../include/hw/qdev-core.h.html#DeviceClass::reset" title='DeviceClass::reset' data-ref="DeviceClass::reset">reset</a> = <a class="tu ref" href="#i8257_reset" title='i8257_reset' data-use='r' data-ref="i8257_reset">i8257_reset</a>;</td></tr>
<tr><th id="592">592</th><td>    <a class="local col1 ref" href="#221dc" title='dc' data-ref="221dc">dc</a>-&gt;<a class="ref" href="../../include/hw/qdev-core.h.html#DeviceClass::vmsd" title='DeviceClass::vmsd' data-ref="DeviceClass::vmsd">vmsd</a> = &amp;<a class="tu ref" href="#vmstate_i8257" title='vmstate_i8257' data-use='a' data-ref="vmstate_i8257">vmstate_i8257</a>;</td></tr>
<tr><th id="593">593</th><td>    <a class="local col1 ref" href="#221dc" title='dc' data-ref="221dc">dc</a>-&gt;<a class="ref" href="../../include/hw/qdev-core.h.html#DeviceClass::props" title='DeviceClass::props' data-ref="DeviceClass::props">props</a> = <a class="tu ref" href="#i8257_properties" title='i8257_properties' data-use='r' data-ref="i8257_properties">i8257_properties</a>;</td></tr>
<tr><th id="594">594</th><td></td></tr>
<tr><th id="595">595</th><td>    <a class="local col2 ref" href="#222idc" title='idc' data-ref="222idc">idc</a>-&gt;<a class="ref" href="../../include/hw/isa/isa.h.html#IsaDmaClass::get_transfer_mode" title='IsaDmaClass::get_transfer_mode' data-ref="IsaDmaClass::get_transfer_mode">get_transfer_mode</a> = <a class="tu ref" href="#i8257_dma_get_transfer_mode" title='i8257_dma_get_transfer_mode' data-use='r' data-ref="i8257_dma_get_transfer_mode">i8257_dma_get_transfer_mode</a>;</td></tr>
<tr><th id="596">596</th><td>    <a class="local col2 ref" href="#222idc" title='idc' data-ref="222idc">idc</a>-&gt;<a class="ref" href="../../include/hw/isa/isa.h.html#IsaDmaClass::has_autoinitialization" title='IsaDmaClass::has_autoinitialization' data-ref="IsaDmaClass::has_autoinitialization">has_autoinitialization</a> = <a class="tu ref" href="#i8257_dma_has_autoinitialization" title='i8257_dma_has_autoinitialization' data-use='r' data-ref="i8257_dma_has_autoinitialization">i8257_dma_has_autoinitialization</a>;</td></tr>
<tr><th id="597">597</th><td>    <a class="local col2 ref" href="#222idc" title='idc' data-ref="222idc">idc</a>-&gt;<a class="ref" href="../../include/hw/isa/isa.h.html#IsaDmaClass::read_memory" title='IsaDmaClass::read_memory' data-ref="IsaDmaClass::read_memory">read_memory</a> = <a class="tu ref" href="#i8257_dma_read_memory" title='i8257_dma_read_memory' data-use='r' data-ref="i8257_dma_read_memory">i8257_dma_read_memory</a>;</td></tr>
<tr><th id="598">598</th><td>    <a class="local col2 ref" href="#222idc" title='idc' data-ref="222idc">idc</a>-&gt;<a class="ref" href="../../include/hw/isa/isa.h.html#IsaDmaClass::write_memory" title='IsaDmaClass::write_memory' data-ref="IsaDmaClass::write_memory">write_memory</a> = <a class="tu ref" href="#i8257_dma_write_memory" title='i8257_dma_write_memory' data-use='r' data-ref="i8257_dma_write_memory">i8257_dma_write_memory</a>;</td></tr>
<tr><th id="599">599</th><td>    <a class="local col2 ref" href="#222idc" title='idc' data-ref="222idc">idc</a>-&gt;<a class="ref" href="../../include/hw/isa/isa.h.html#IsaDmaClass::hold_DREQ" title='IsaDmaClass::hold_DREQ' data-ref="IsaDmaClass::hold_DREQ">hold_DREQ</a> = <a class="tu ref" href="#i8257_dma_hold_DREQ" title='i8257_dma_hold_DREQ' data-use='r' data-ref="i8257_dma_hold_DREQ">i8257_dma_hold_DREQ</a>;</td></tr>
<tr><th id="600">600</th><td>    <a class="local col2 ref" href="#222idc" title='idc' data-ref="222idc">idc</a>-&gt;<a class="ref" href="../../include/hw/isa/isa.h.html#IsaDmaClass::release_DREQ" title='IsaDmaClass::release_DREQ' data-ref="IsaDmaClass::release_DREQ">release_DREQ</a> = <a class="tu ref" href="#i8257_dma_release_DREQ" title='i8257_dma_release_DREQ' data-use='r' data-ref="i8257_dma_release_DREQ">i8257_dma_release_DREQ</a>;</td></tr>
<tr><th id="601">601</th><td>    <a class="local col2 ref" href="#222idc" title='idc' data-ref="222idc">idc</a>-&gt;<a class="ref" href="../../include/hw/isa/isa.h.html#IsaDmaClass::schedule" title='IsaDmaClass::schedule' data-ref="IsaDmaClass::schedule">schedule</a> = <a class="tu ref" href="#i8257_dma_schedule" title='i8257_dma_schedule' data-use='r' data-ref="i8257_dma_schedule">i8257_dma_schedule</a>;</td></tr>
<tr><th id="602">602</th><td>    <a class="local col2 ref" href="#222idc" title='idc' data-ref="222idc">idc</a>-&gt;<a class="ref" href="../../include/hw/isa/isa.h.html#IsaDmaClass::register_channel" title='IsaDmaClass::register_channel' data-ref="IsaDmaClass::register_channel">register_channel</a> = <a class="tu ref" href="#i8257_dma_register_channel" title='i8257_dma_register_channel' data-use='r' data-ref="i8257_dma_register_channel">i8257_dma_register_channel</a>;</td></tr>
<tr><th id="603">603</th><td>    <i>/* Reason: needs to be wired up by isa_bus_dma() to work */</i></td></tr>
<tr><th id="604">604</th><td>    <a class="local col1 ref" href="#221dc" title='dc' data-ref="221dc">dc</a>-&gt;<a class="ref" href="../../include/hw/qdev-core.h.html#DeviceClass::user_creatable" title='DeviceClass::user_creatable' data-ref="DeviceClass::user_creatable">user_creatable</a> = <span class="macro" title="0" data-ref="_M/false">false</span>;</td></tr>
<tr><th id="605">605</th><td>}</td></tr>
<tr><th id="606">606</th><td></td></tr>
<tr><th id="607">607</th><td><em>static</em> <em>const</em> <a class="typedef" href="../../include/qom/object.h.html#TypeInfo" title='TypeInfo' data-type='struct TypeInfo' data-ref="TypeInfo">TypeInfo</a> <dfn class="tu decl def" id="i8257_info" title='i8257_info' data-type='const TypeInfo' data-ref="i8257_info">i8257_info</dfn> = {</td></tr>
<tr><th id="608">608</th><td>    .<a class="ref" href="../../include/qom/object.h.html#TypeInfo::name" title='TypeInfo::name' data-ref="TypeInfo::name">name</a> = <a class="macro" href="../../include/hw/isa/i8257.h.html#4" title="&quot;i8257&quot;" data-ref="_M/TYPE_I8257">TYPE_I8257</a>,</td></tr>
<tr><th id="609">609</th><td>    .<a class="ref" href="../../include/qom/object.h.html#TypeInfo::parent" title='TypeInfo::parent' data-ref="TypeInfo::parent">parent</a> = <a class="macro" href="../../include/hw/isa/isa.h.html#12" title="&quot;isa-device&quot;" data-ref="_M/TYPE_ISA_DEVICE">TYPE_ISA_DEVICE</a>,</td></tr>
<tr><th id="610">610</th><td>    .<a class="ref" href="../../include/qom/object.h.html#TypeInfo::instance_size" title='TypeInfo::instance_size' data-ref="TypeInfo::instance_size">instance_size</a> = <b>sizeof</b>(<a class="typedef" href="../../include/hw/isa/i8257.h.html#I8257State" title='I8257State' data-type='struct I8257State' data-ref="I8257State">I8257State</a>),</td></tr>
<tr><th id="611">611</th><td>    .<a class="ref" href="../../include/qom/object.h.html#TypeInfo::class_init" title='TypeInfo::class_init' data-ref="TypeInfo::class_init">class_init</a> = <a class="tu ref" href="#i8257_class_init" title='i8257_class_init' data-ref="i8257_class_init">i8257_class_init</a>,</td></tr>
<tr><th id="612">612</th><td>    .<a class="ref" href="../../include/qom/object.h.html#TypeInfo::interfaces" title='TypeInfo::interfaces' data-ref="TypeInfo::interfaces">interfaces</a> = (<a class="typedef" href="../../include/qom/object.h.html#InterfaceInfo" title='InterfaceInfo' data-type='struct InterfaceInfo' data-ref="InterfaceInfo">InterfaceInfo</a>[]) {</td></tr>
<tr><th id="613">613</th><td>        { <a class="macro" href="../../include/hw/isa/isa.h.html#37" title="&quot;isa-dma&quot;" data-ref="_M/TYPE_ISADMA">TYPE_ISADMA</a> },</td></tr>
<tr><th id="614">614</th><td>        { }</td></tr>
<tr><th id="615">615</th><td>    }</td></tr>
<tr><th id="616">616</th><td>};</td></tr>
<tr><th id="617">617</th><td></td></tr>
<tr><th id="618">618</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="i8257_register_types" title='i8257_register_types' data-type='void i8257_register_types()' data-ref="i8257_register_types">i8257_register_types</dfn>(<em>void</em>)</td></tr>
<tr><th id="619">619</th><td>{</td></tr>
<tr><th id="620">620</th><td>    <a class="ref" href="../../include/qom/object.h.html#type_register_static" title='type_register_static' data-ref="type_register_static">type_register_static</a>(&amp;<a class="tu ref" href="#i8257_info" title='i8257_info' data-use='a' data-ref="i8257_info">i8257_info</a>);</td></tr>
<tr><th id="621">621</th><td>}</td></tr>
<tr><th id="622">622</th><td></td></tr>
<tr><th id="623">623</th><td><a class="macro" href="../../include/qemu/module.h.html#52" title="static void __attribute__((constructor)) do_qemu_init_i8257_register_types(void) { register_module_init(i8257_register_types, MODULE_INIT_QOM); }" data-ref="_M/type_init">type_init</a>(<a class="tu ref" href="#i8257_register_types" title='i8257_register_types' data-use='r' data-ref="i8257_register_types">i8257_register_types</a>)</td></tr>
<tr><th id="624">624</th><td></td></tr>
<tr><th id="625">625</th><td><em>void</em> <dfn class="decl def" id="DMA_init" title='DMA_init' data-ref="DMA_init">DMA_init</dfn>(<a class="typedef" href="../../include/qemu/typedefs.h.html#ISABus" title='ISABus' data-type='struct ISABus' data-ref="ISABus">ISABus</a> *<dfn class="local col3 decl" id="223bus" title='bus' data-type='ISABus *' data-ref="223bus">bus</dfn>, <em>int</em> <dfn class="local col4 decl" id="224high_page_enable" title='high_page_enable' data-type='int' data-ref="224high_page_enable">high_page_enable</dfn>)</td></tr>
<tr><th id="626">626</th><td>{</td></tr>
<tr><th id="627">627</th><td>    <a class="typedef" href="../../include/qemu/typedefs.h.html#ISADevice" title='ISADevice' data-type='struct ISADevice' data-ref="ISADevice">ISADevice</a> *<dfn class="local col5 decl" id="225isa1" title='isa1' data-type='ISADevice *' data-ref="225isa1">isa1</dfn>, *<dfn class="local col6 decl" id="226isa2" title='isa2' data-type='ISADevice *' data-ref="226isa2">isa2</dfn>;</td></tr>
<tr><th id="628">628</th><td>    <a class="typedef" href="../../include/qemu/typedefs.h.html#DeviceState" title='DeviceState' data-type='struct DeviceState' data-ref="DeviceState">DeviceState</a> *<dfn class="local col7 decl" id="227d" title='d' data-type='DeviceState *' data-ref="227d">d</dfn>;</td></tr>
<tr><th id="629">629</th><td></td></tr>
<tr><th id="630">630</th><td>    <a class="local col5 ref" href="#225isa1" title='isa1' data-ref="225isa1">isa1</a> = <a class="ref" href="../../include/hw/isa/isa.h.html#isa_create" title='isa_create' data-ref="isa_create">isa_create</a>(<a class="local col3 ref" href="#223bus" title='bus' data-ref="223bus">bus</a>, <a class="macro" href="../../include/hw/isa/i8257.h.html#4" title="&quot;i8257&quot;" data-ref="_M/TYPE_I8257">TYPE_I8257</a>);</td></tr>
<tr><th id="631">631</th><td>    <a class="local col7 ref" href="#227d" title='d' data-ref="227d">d</a> = <a class="macro" href="../../include/hw/qdev-core.h.html#16" title="((DeviceState *)object_dynamic_cast_assert(((Object *)((isa1))), (&quot;device&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 631, __func__))" data-ref="_M/DEVICE">DEVICE</a>(<a class="local col5 ref" href="#225isa1" title='isa1' data-ref="225isa1">isa1</a>);</td></tr>
<tr><th id="632">632</th><td>    <a class="ref" href="../../include/hw/qdev-properties.h.html#qdev_prop_set_int32" title='qdev_prop_set_int32' data-ref="qdev_prop_set_int32">qdev_prop_set_int32</a>(<a class="local col7 ref" href="#227d" title='d' data-ref="227d">d</a>, <q>"base"</q>, <var>0x00</var>);</td></tr>
<tr><th id="633">633</th><td>    <a class="ref" href="../../include/hw/qdev-properties.h.html#qdev_prop_set_int32" title='qdev_prop_set_int32' data-ref="qdev_prop_set_int32">qdev_prop_set_int32</a>(<a class="local col7 ref" href="#227d" title='d' data-ref="227d">d</a>, <q>"page-base"</q>, <var>0x80</var>);</td></tr>
<tr><th id="634">634</th><td>    <a class="ref" href="../../include/hw/qdev-properties.h.html#qdev_prop_set_int32" title='qdev_prop_set_int32' data-ref="qdev_prop_set_int32">qdev_prop_set_int32</a>(<a class="local col7 ref" href="#227d" title='d' data-ref="227d">d</a>, <q>"pageh-base"</q>, <a class="local col4 ref" href="#224high_page_enable" title='high_page_enable' data-ref="224high_page_enable">high_page_enable</a> ? <var>0x480</var> : -<var>1</var>);</td></tr>
<tr><th id="635">635</th><td>    <a class="ref" href="../../include/hw/qdev-properties.h.html#qdev_prop_set_int32" title='qdev_prop_set_int32' data-ref="qdev_prop_set_int32">qdev_prop_set_int32</a>(<a class="local col7 ref" href="#227d" title='d' data-ref="227d">d</a>, <q>"dshift"</q>, <var>0</var>);</td></tr>
<tr><th id="636">636</th><td>    <a class="ref" href="../../include/hw/qdev-core.h.html#qdev_init_nofail" title='qdev_init_nofail' data-ref="qdev_init_nofail">qdev_init_nofail</a>(<a class="local col7 ref" href="#227d" title='d' data-ref="227d">d</a>);</td></tr>
<tr><th id="637">637</th><td></td></tr>
<tr><th id="638">638</th><td>    <a class="local col6 ref" href="#226isa2" title='isa2' data-ref="226isa2">isa2</a> = <a class="ref" href="../../include/hw/isa/isa.h.html#isa_create" title='isa_create' data-ref="isa_create">isa_create</a>(<a class="local col3 ref" href="#223bus" title='bus' data-ref="223bus">bus</a>, <a class="macro" href="../../include/hw/isa/i8257.h.html#4" title="&quot;i8257&quot;" data-ref="_M/TYPE_I8257">TYPE_I8257</a>);</td></tr>
<tr><th id="639">639</th><td>    <a class="local col7 ref" href="#227d" title='d' data-ref="227d">d</a> = <a class="macro" href="../../include/hw/qdev-core.h.html#16" title="((DeviceState *)object_dynamic_cast_assert(((Object *)((isa2))), (&quot;device&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 639, __func__))" data-ref="_M/DEVICE">DEVICE</a>(<a class="local col6 ref" href="#226isa2" title='isa2' data-ref="226isa2">isa2</a>);</td></tr>
<tr><th id="640">640</th><td>    <a class="ref" href="../../include/hw/qdev-properties.h.html#qdev_prop_set_int32" title='qdev_prop_set_int32' data-ref="qdev_prop_set_int32">qdev_prop_set_int32</a>(<a class="local col7 ref" href="#227d" title='d' data-ref="227d">d</a>, <q>"base"</q>, <var>0xc0</var>);</td></tr>
<tr><th id="641">641</th><td>    <a class="ref" href="../../include/hw/qdev-properties.h.html#qdev_prop_set_int32" title='qdev_prop_set_int32' data-ref="qdev_prop_set_int32">qdev_prop_set_int32</a>(<a class="local col7 ref" href="#227d" title='d' data-ref="227d">d</a>, <q>"page-base"</q>, <var>0x88</var>);</td></tr>
<tr><th id="642">642</th><td>    <a class="ref" href="../../include/hw/qdev-properties.h.html#qdev_prop_set_int32" title='qdev_prop_set_int32' data-ref="qdev_prop_set_int32">qdev_prop_set_int32</a>(<a class="local col7 ref" href="#227d" title='d' data-ref="227d">d</a>, <q>"pageh-base"</q>, <a class="local col4 ref" href="#224high_page_enable" title='high_page_enable' data-ref="224high_page_enable">high_page_enable</a> ? <var>0x488</var> : -<var>1</var>);</td></tr>
<tr><th id="643">643</th><td>    <a class="ref" href="../../include/hw/qdev-properties.h.html#qdev_prop_set_int32" title='qdev_prop_set_int32' data-ref="qdev_prop_set_int32">qdev_prop_set_int32</a>(<a class="local col7 ref" href="#227d" title='d' data-ref="227d">d</a>, <q>"dshift"</q>, <var>1</var>);</td></tr>
<tr><th id="644">644</th><td>    <a class="ref" href="../../include/hw/qdev-core.h.html#qdev_init_nofail" title='qdev_init_nofail' data-ref="qdev_init_nofail">qdev_init_nofail</a>(<a class="local col7 ref" href="#227d" title='d' data-ref="227d">d</a>);</td></tr>
<tr><th id="645">645</th><td></td></tr>
<tr><th id="646">646</th><td>    <a class="ref" href="../../include/hw/isa/isa.h.html#isa_bus_dma" title='isa_bus_dma' data-ref="isa_bus_dma">isa_bus_dma</a>(<a class="local col3 ref" href="#223bus" title='bus' data-ref="223bus">bus</a>, <a class="macro" href="../../include/hw/isa/isa.h.html#43" title="((IsaDma *)object_dynamic_cast_assert(((Object *)(((isa1)))), (&quot;isa-dma&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 646, __func__))" data-ref="_M/ISADMA">ISADMA</a>(<a class="local col5 ref" href="#225isa1" title='isa1' data-ref="225isa1">isa1</a>), <a class="macro" href="../../include/hw/isa/isa.h.html#43" title="((IsaDma *)object_dynamic_cast_assert(((Object *)(((isa2)))), (&quot;isa-dma&quot;), &quot;/home/jon/workspace/qemu/hw/dma/i8257.c&quot;, 646, __func__))" data-ref="_M/ISADMA">ISADMA</a>(<a class="local col6 ref" href="#226isa2" title='isa2' data-ref="226isa2">isa2</a>));</td></tr>
<tr><th id="647">647</th><td>}</td></tr>
<tr><th id="648">648</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2017-Aug-28</em> from project codebrowser revision <em>v2.10.0-rc0-7-g6be37cc</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
